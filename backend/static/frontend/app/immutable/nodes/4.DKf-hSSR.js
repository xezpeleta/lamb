import{d as ir,t as g,b as c,s as o,f as ua,r as Gr,e as Fr,g as _r,n as xr}from"../chunks/DbBWcICI.js";import{E as is,p as nr,j as b,I as tr,av as ns,k as It,A as qr,q as r,m as e,w as He,o as a,r as t,l as i,n as lr,t as f,v as or,aD as Ua,u as Oa,aq as vs,aC as Va,aO as ls,ab as gs}from"../chunks/DMsokd5p.js";import{i as k}from"../chunks/MBI0PpQy.js";import{e as ya,i as ar}from"../chunks/D6e1hy_S.js";import{a as Ot,s as wa,r as Ma}from"../chunks/gPkShxx4.js";import{s as Vr}from"../chunks/CG3iaoFh.js";import{a as ka,s as yr}from"../chunks/BsHaMxS4.js";import{h as Ha}from"../chunks/QT65TrHe.js";import{b as rr,g as sr}from"../chunks/DSbmFsaz.js";import{a as hr,$ as wr}from"../chunks/DISYGKE3.js";import{u as Hr}from"../chunks/CmzVOFLo.js";import{g as Wa,a as zr}from"../chunks/BWNE5xtz.js";import{a as Pr}from"../chunks/t--hEgTQ.js";import{b as Ba,a as ms,c as Wr}from"../chunks/CFRbuANL.js";import{b as Tr}from"../chunks/BVQ_Nsm3.js";import{p as Ft,b as ds}from"../chunks/DEkYYQ3O.js";import{g as cs}from"../chunks/CtNWh4s7.js";import{p as Yr}from"../chunks/CSm_io3U.js";const bs=!0,Zr=bs,_s=is(!1);async function hs(I=10,d=0){const p=localStorage.getItem("userToken");if(!p)throw new Error("Not authenticated");console.log("Checking window.LAMB_CONFIG in getAssistants:",window.LAMB_CONFIG,"typeof:",typeof window.LAMB_CONFIG),window.LAMB_CONFIG&&(console.log("Checking window.LAMB_CONFIG.api:",window.LAMB_CONFIG.api,"typeof:",typeof window.LAMB_CONFIG.api),window.LAMB_CONFIG.api&&console.log("Checking window.LAMB_CONFIG.api.lambServer:",window.LAMB_CONFIG.api.lambServer,"typeof:",typeof window.LAMB_CONFIG.api.lambServer));const L=new URLSearchParams({limit:I.toString(),offset:d.toString()}),E=Wa(`/assistant/get_assistants?${L}`);console.log("Fetching assistants from absolute URL:",E),console.log(`Equivalent curl command:
curl -X GET "${E}" -H "Authorization: Bearer ${p}"`);const s=await fetch(E,{headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"}});if(!s.ok){let n="Failed to fetch assistants";try{const l=await s.json();n=(l==null?void 0:l.detail)||n}catch{}throw console.error("API error response status:",s.status,"Detail:",n),new Error(n)}const v=await s.json();return{assistants:Array.isArray(v==null?void 0:v.assistants)?v.assistants:[],total_count:typeof(v==null?void 0:v.total_count)=="number"?v.total_count:0}}async function Xr(I){const d=localStorage.getItem("userToken");if(!d)throw new Error("Not authenticated");const p=Wa(`/assistant/get_assistant/${I}`);console.log("Fetching assistant by ID from absolute URL:",p);const L=await fetch(p,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});if(!L.ok){let E=`Failed to fetch assistant with ID ${I}`;try{const s=await L.json();E=(s==null?void 0:s.detail)||E}catch{}throw console.error("API error response status:",L.status,"Detail:",E),new Error(E)}return await L.json()}async function xs(I,d,p){const L=localStorage.getItem("userToken");if(!L)throw new Error("Not authenticated");const E=Wa(`/assistant/unpublish_assistant/${I}/${d}?user_email=${encodeURIComponent(p)}`),s=await fetch(E,{method:"DELETE",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}});if(!s.ok){let v="Failed to unpublish assistant";try{const n=await s.json();v=(n==null?void 0:n.detail)||v}catch{}throw console.error("Unpublish error:",s.status,v),new Error(v)}return await s.json()}async function ys(I){try{const d=localStorage.getItem("userToken");if(!d)throw new Error("Not authenticated");const p=localStorage.getItem("userEmail");if(!p)throw new Error("User email not found in localStorage");const L=Wa(`/assistant/delete_assistant/${I}?owner=${encodeURIComponent(p)}`),E=await fetch(L,{method:"DELETE",headers:{Authorization:`Bearer ${d}`}});if(!E.ok){let v={detail:`Error: ${E.status}`};try{v=await E.json()}catch{}throw E.status===403?new Error("You do not have permission to delete this assistant"):E.status===404?new Error("Assistant not found"):new Error(v.detail||`Error: ${E.status}`)}const s=await E.text();return s?JSON.parse(s):{}}catch(d){throw console.error("Error deleting assistant:",d),d instanceof Error?d:new Error("An unknown error occurred during assistant deletion")}}async function us(I){var L;const d=localStorage.getItem("userToken");if(!d)throw new Error("Not authenticated");const p=Wa("/assistant/create_assistant");console.log("Creating assistant with data:",I);try{const E=await Pr.post(p,I,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});return console.log("Assistant created successfully:",E.data),E.data}catch(E){console.error("Error creating assistant:",E);let s="Failed to create assistant.";if(Pr.isAxiosError(E)&&E.response){const v=E.response.data;if(console.error("API Error Response:",v),(L=v==null?void 0:v.detail)!=null&&L.includes("already exists for this owner")){const n=v.detail.match(/named '([^']+)' already exists/);s=`An assistant named '${n?n[1]:"this name"}' already exists. Please choose a different name.`}else s=(v==null?void 0:v.detail)||(v==null?void 0:v.message)||`Request failed with status ${E.response.status}`}else E instanceof Error&&(s=E.message);throw new Error(s)}}async function ws(I,d){const p=localStorage.getItem("userToken");if(!p)throw new Error("Not authenticated");const L=["name","description","system_prompt","prompt_template","RAG_Top_k","RAG_collections","metadata"],E=Object.keys(d).filter(v=>L.includes(v)).reduce((v,n)=>{const l=v;return d[n]!==null&&d[n]!==void 0?l[n]=d[n]:n==="description"&&(l[n]=""),l},{}),s=Wa(`/assistant/update_assistant/${I}`);console.log(`Updating assistant ${I} at URL:`,s),console.log("With data:",E);try{const v=await fetch(s,{method:"PUT",headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify(E)});if(!v.ok){let n=`Failed to update assistant with ID ${I}`;try{const l=await v.json();n=(l==null?void 0:l.detail)||n}catch{}throw console.error("API error response status:",v.status,"Detail:",n),new Error(n)}return await v.json()}catch(v){console.error("Error updating assistant:",v);let n="Failed to update assistant.";throw v instanceof Error&&(n=v.message),new Error(n)}}async function ks(I,d){const p=localStorage.getItem("userToken");if(!p)throw new Error("Not authenticated");const L=`/assistant/publish/${I}`,E=Wa(L);console.log(`Setting publish status to ${d} for ${I} at ${E}`);const s="PUT";try{const v=await fetch(E,{method:s,headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify({publish_status:d})});if(!v.ok){let n=`Failed to set publish status for assistant ${I}`;try{const l=await v.json();n=(l==null?void 0:l.detail)||n}catch{}throw console.error("API error response status:",v.status,"Detail:",n),new Error(n)}return await v.json()}catch(v){console.error("Error setting publish status:",v);let n="Failed to set publish status.";throw v instanceof Error&&(n=v.message),new Error(n)}}ir(["click"]);async function As(I,d,p,L,E){e(d)||(console.log("Manual refresh triggered..."),r(d,!0),await p(e(L),E),r(d,!1))}function Es(I,d,p,L){e(d)>1&&p(e(d)-1,L)}function Cs(I,d,p,L,E){e(d)<e(p)&&L(e(d)+1,E)}var $s=g('<p class="text-center text-gray-500 py-4"> </p>'),Ss=g('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold"> </strong> <span class="block sm:inline"> </span></div>'),Is=g('<p class="text-center text-gray-500 py-4"> </p>'),Ns=(I,d,p)=>d(e(p).id),Ds=g('<span class="inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 px-2 py-0.5"> </span>'),Ts=g('<span class="inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 px-2 py-0.5"> </span>'),Ps=(I,d,p)=>d(e(p).id),Fs=(I,d,p)=>d("duplicate",{id:e(p).id,name:e(p).name}),Ls=(I,d,p)=>d("export",{id:e(p).id}),Rs=(I,d,p)=>d({detail:{assistantId:e(p).id,groupId:e(p).group_id,ownerEmail:e(p).owner}}),Ms=g('<button class="text-yellow-600 hover:text-yellow-900 p-1 rounded hover:bg-yellow-100 transition-colors duration-150"><!></button>'),Bs=(I,d,p)=>d("delete",{id:e(p).id,name:e(p).name,published:e(p).published}),Us=g('<button class="text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-100 transition-colors duration-150"><!></button>'),Os=g('<tr class="bg-gray-50 border-b border-gray-200"><td colspan="2" class="px-6 py-2 text-sm"><div class="flex flex-wrap"><div class="mr-6 mb-1"><span class="text-brand font-medium"> </span> <span class="ml-1"> </span></div> <div><span class="text-brand font-medium"> </span> <span class="ml-1 truncate"> </span></div></div></td><td class="px-6 py-2"></td></tr>'),js=g('<tr class="bg-gray-50 border-b border-gray-200"><td colspan="2" class="px-6 py-2 text-sm"><div class="flex flex-wrap items-center"><span class="text-brand font-medium mr-1"> </span> <span class="mr-3"> </span> <span class="text-brand font-medium mr-1"> </span> <span class="mr-3"> </span> <span class="text-brand font-medium mr-1"> </span> <span class="mr-3"> </span> <span class="text-brand font-medium mr-1"> </span> <span> </span></div></td><td class="px-6 py-2"></td></tr> <!>',1),Gs=g('<tr class="bg-gray-50 border-b border-gray-200"><td colspan="2" class="px-6 py-2 text-sm text-gray-500"><span class="text-brand font-medium"> </span> <span class="ml-1"> </span></td><td class="px-6 py-2"></td></tr>'),Ks=g('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-normal align-top"><button class="text-sm font-medium text-brand hover:underline break-words text-left"> </button> <div class="mt-1"><!></div></td><td class="px-6 py-4 align-top"><div class="text-sm text-gray-500 break-words max-w-md"> </div></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium align-top"><div class="flex items-center space-x-1 sm:space-x-2"><button class="text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-100 transition-colors duration-150"><!></button> <button class="text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-100 transition-colors duration-150"><!></button> <button class="text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-100 transition-colors duration-150"><!></button> <!></div> <div class="text-xs text-gray-400 mt-2"> </div></td></tr> <!>',1),zs=g('<div class="flex justify-center items-center mt-4 space-x-4 text-sm text-gray-700"><button class="p-1.5 font-medium bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"><span><!></span></button> <button class="px-3 py-1 font-medium bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> </button> <span> <span class="mx-2">|</span> <span class="font-medium text-brand"> </span> <span class="font-medium text-brand"> </span> <span class="font-medium text-brand"> </span></span> <button class="px-3 py-1 font-medium bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> </button></div>'),qs=g('<div class="overflow-x-auto shadow-md sm:rounded-lg mb-6 border border-gray-200"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-brand uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-brand uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-brand uppercase tracking-wider"> </th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div> <!>',1),Js=g('<div class="container mx-auto px-4 py-8"><!></div> <!>',1);function Vs(I,d){nr(d,!0);const[p,L]=yr(),E=()=>ka(Hr,"$user",p),s=()=>ka(wr,"$_",p),v=()=>ka(_s,"$publishModalOpen",p);let n=b(!!tr(hr));const l=ns();let m=b(It([])),W=b(!0),fe=b(null),F=5,K=b(1),z=b(0),M=Ua(()=>Math.ceil(e(z)/F)),je=()=>{},ye=()=>{};qr(()=>(je=hr.subscribe(N=>{N&&r(n,!0)}),ye=Hr.subscribe(O=>{O.isLoggedIn?e(m).length===0&&!e(W)&&(console.log("User logged in, loading initial assistants..."),he(1,F)):(console.log("User logged out, clearing assistants."),r(m,[],!0),r(z,0),r(K,1),r(fe,null),r(W,!1))}),E().isLoggedIn&&(console.log("User already logged in on mount, loading initial assistants..."),he(e(K),F)),()=>{je(),ye&&ye()}));let Pe=b(!1);async function he(N,O){r(W,!0),r(fe,null);try{const se=(N-1)*O;console.log(`Calling getAssistants with limit=${O}, offset=${se}`);const ee=await hs(O,se);console.log("Received data from getAssistants:",ee),r(m,ee.assistants,!0),r(z,ee.total_count,!0),r(K,N,!0)}catch(se){console.error("Error loading assistants:",se),r(fe,se instanceof Error?se.message:"Failed to load assistants",!0),r(m,[],!0),r(z,0)}finally{r(W,!1)}await new Promise(se=>setTimeout(se,500)),r(W,!1)}function X(N){console.log(`View assistant (navigate to detail view): ${N}`);const O=`${rr}/assistants?view=detail&id=${N}`;console.log("[AssistantsList] Navigating to view:",O),sr(O)}async function ve(N){const O=Number(N.detail.assistantId),{groupId:se,ownerEmail:ee}=N.detail;if(!se||!ee){alert(e(n)?s()("assistants.unpublishErrorMissingData"):"Cannot unpublish: Missing group ID or owner email.");return}const ae=e(m).find(Ne=>Ne.id===O),ue=e(n)?s()("assistants.unpublishConfirm",{values:{name:(ae==null?void 0:ae.name)||O}}):`Are you sure you want to unpublish assistant ${O}?`;if(confirm(ue))try{await xs(O.toString(),se,ee),await he(e(K),F),alert(e(n)?s()("assistants.unpublishSuccess"):"Assistant unpublished successfully!")}catch(Ne){console.error("Error unpublishing assistant:",Ne);const ge=Ne instanceof Error?Ne.message:"Failed to unpublish assistant";r(fe,ge,!0),alert(e(n)?s()("assistants.unpublishError",{values:{error:ge}}):`Error: ${ge}`)}}function re(N){if(!N)return{};try{return JSON.parse(N)}catch(O){return console.error("Error parsing metadata:",O,N),{}}}const Fe='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg>',Ce='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75c-.621 0-1.125-.504-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75" /></svg>',we='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" /></svg>',le='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" /></svg>',J='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>',be='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75c-.621 0-1.125-.504-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75" /></svg>';var _e=Js(),Le=He(_e),Re=a(Le);{var T=N=>{var O=$s(),se=a(O,!0);t(O),f(ee=>o(se,ee),[()=>e(n)?s()("assistants.loading",{default:"Loading assistants..."}):"Loading assistants..."]),c(N,O)},B=(N,O)=>{{var se=ae=>{var ue=Ss(),Ne=a(ue),ge=a(Ne,!0);t(Ne);var xe=i(Ne,2),q=a(xe,!0);t(xe),t(ue),f(ie=>{o(ge,ie),o(q,e(fe))},[()=>e(n)?s()("assistants.errorTitle"):"Error:"]),c(ae,ue)},ee=(ae,ue)=>{{var Ne=xe=>{var q=Is(),ie=a(q,!0);t(q),f(Se=>o(ie,Se),[()=>e(n)?s()("assistants.noAssistants",{default:"No assistants found."}):"No assistants found."]),c(xe,q)},ge=xe=>{var q=qs(),ie=He(q),Se=a(ie),Wt=a(Se),Aa=a(Wt),Ea=a(Aa),Ya=a(Ea,!0);t(Ea);var jt=i(Ea),Na=a(jt,!0);t(jt);var pa=i(jt),fa=a(pa,!0);t(pa),t(Aa),t(Wt);var va=i(Wt);ya(va,21,()=>e(m),ot=>ot.id,(ot,$e)=>{var bt=Ks(),Yt=He(bt),Zt=a(Yt),ma=a(Zt);ma.__click=[Ns,X,$e];var Xt=a(ma,!0);t(ma);var Qt=i(ma,2),ea=a(Qt);{var ta=j=>{var U=Ds(),G=a(U,!0);t(U),f(V=>o(G,V),[()=>e(n)?s()("assistants.status.published",{default:"Published"}):"Published"]),c(j,U)},ba=j=>{var U=Ts(),G=a(U,!0);t(U),f(V=>o(G,V),[()=>e(n)?s()("assistants.status.unpublished",{default:"Unpublished"}):"Unpublished"]),c(j,U)};k(ea,j=>{e($e).published?j(ta):j(ba,!1)})}t(Qt),t(Zt);var aa=i(Zt),Da=a(aa),_=a(Da,!0);t(Da),t(aa);var y=i(aa),S=a(y),R=a(S);R.__click=[Ps,X,$e];var P=a(R);Ha(P,()=>Fe),t(R);var De=i(R,2);De.__click=[Fs,l,$e];var me=a(De);Ha(me,()=>Ce),t(De);var gt=i(De,2);gt.__click=[Ls,l,$e];var ze=a(gt);Ha(ze,()=>J),t(gt);var u=i(gt,2);{var A=j=>{var U=Ms();U.__click=[Rs,ve,$e];var G=a(U);Ha(G,()=>be),t(U),f(V=>Ot(U,"title",V),[()=>e(n)?s()("assistants.actions.unpublish",{default:"Unpublish"}):"Unpublish"]),c(j,U)},$=j=>{var U=Us();U.__click=[Bs,l,$e];var G=a(U);Ha(G,()=>we),t(U),f(V=>Ot(U,"title",V),[()=>e(n)?s()("assistants.actions.delete",{default:"Delete"}):"Delete"]),c(j,U)};k(u,j=>{e($e).published?j(A):j($,!1)})}t(S);var w=i(S,2),D=a(w);t(w),t(y),t(Yt);var Y=i(Yt,2);{var Z=j=>{var U=js();const G=Ua(()=>re(e($e).metadata));var V=He(U),Ie=a(V),Nt=a(Ie),Me=a(Nt),We=a(Me);t(Me);var oe=i(Me,2),te=a(oe,!0);t(oe);var _t=i(oe,2),Ge=a(_t);t(_t);var qe=i(_t,2),Lt=a(qe,!0);t(qe);var Je=i(qe,2),Ye=a(Je);t(Je);var ht=i(Je,2),Ga=a(ht,!0);t(ht);var xt=i(ht,2),_a=a(xt);t(xt);var Gt=i(xt,2),ra=a(Gt,!0);t(Gt),t(Nt),t(Ie),or(),t(V);var Kt=i(V,2);{var yt=Ze=>{var it=Os(),dt=a(it),wt=a(dt),Xe=a(wt),Rt=a(Xe),Dt=a(Rt);t(Rt);var Qe=i(Rt,2),ct=a(Qe,!0);t(Qe),t(Xe);var ha=i(Xe,2),ut=a(ha),Tt=a(ut);t(ut);var nt=i(ut,2),Mt=a(nt,!0);t(nt),t(ha),t(wt),t(dt),or(),t(it),f((Ta,xa,sa,Ka)=>{o(Dt,`${Ta??""}:`),o(ct,xa),o(Tt,`${sa??""}:`),Ot(nt,"title",e($e).RAG_collections||""),o(Mt,Ka)},[()=>e(n)?s()("assistants.table.ragTopK",{default:"RAG Top K"}):"RAG Top K",()=>e($e).RAG_Top_k??(e(n)?s()("assistants.notSet",{default:"Not set"}):"Not set"),()=>e(n)?s()("assistants.table.ragCollections",{default:"RAG Collections"}):"RAG Collections",()=>e($e).RAG_collections||(e(n)?s()("assistants.notSet",{default:"Not set"}):"Not set")]),c(Ze,it)};k(Kt,Ze=>{e(G).rag_processor==="simple_rag"&&Ze(yt)})}f((Ze,it,dt,wt,Xe,Rt,Dt,Qe)=>{o(We,`${Ze??""}:`),o(te,it),o(Ge,`${dt??""}:`),o(Lt,wt),o(Ye,`${Xe??""}:`),o(Ga,Rt),o(_a,`${Dt??""}:`),o(ra,Qe)},[()=>e(n)?s()("assistants.table.promptProcessor",{default:"Prompt Processor"}):"Prompt Processor",()=>e(G).prompt_processor||(e(n)?s()("assistants.notSet",{default:"Not set"}):"Not set"),()=>e(n)?s()("assistants.table.connector",{default:"Connector"}):"Connector",()=>e(G).connector||(e(n)?s()("assistants.notSet",{default:"Not set"}):"Not set"),()=>e(n)?s()("assistants.table.llm",{default:"LLM"}):"LLM",()=>e(G).llm||(e(n)?s()("assistants.notSet",{default:"Not set"}):"Not set"),()=>e(n)?s()("assistants.table.ragProcessor",{default:"RAG Processor"}):"RAG Processor",()=>e(G).rag_processor||(e(n)?s()("assistants.notSet",{default:"Not set"}):"Not set")]),c(j,U)},Ae=j=>{var U=Gs(),G=a(U),V=a(G),Ie=a(V);t(V);var Nt=i(V,2),Me=a(Nt,!0);t(Nt),t(G),or(),t(U),f((We,oe)=>{o(Ie,`${We??""}:`),o(Me,oe)},[()=>e(n)?s()("assistants.table.config",{default:"Configuration"}):"Configuration",()=>e(n)?s()("assistants.notSet",{default:"Not available"}):"Not available"]),c(j,U)};k(Y,j=>{e($e).metadata?j(Z):j(Ae,!1)})}f((j,U,G,V)=>{o(Xt,e($e).name||"-"),o(_,j),Ot(R,"title",U),Ot(De,"title",G),Ot(gt,"title",V),o(D,`ID: ${e($e).id??""}`)},[()=>e($e).description||(e(n)?s()("assistants.noDescription",{default:"No description provided"}):"No description provided"),()=>e(n)?s()("assistants.actions.view",{default:"View"}):"View",()=>e(n)?s()("assistants.actions.duplicate",{default:"Duplicate"}):"Duplicate",()=>e(n)?s()("assistants.actions.export",{default:"Export JSON"}):"Export JSON"]),c(ot,bt)}),t(va),t(Se),t(ie);var ga=i(ie,2);{var ja=ot=>{var $e=zs(),bt=a($e);bt.__click=[As,Pe,he,K,F];var Yt=a(bt);let Zt;var ma=a(Yt);Ha(ma,()=>le),t(Yt),t(bt);var Xt=i(bt,2);Xt.__click=[Es,K,he,F];var Qt=a(Xt,!0);t(Xt);var ea=i(Xt,2),ta=a(ea),ba=i(ta,2),aa=i(ba),Da=a(aa,!0);t(aa);var _=i(aa),y=i(_),S=a(y,!0);t(y);var R=i(y),P=i(R),De=a(P,!0);t(P),t(ea);var me=i(ea,2);me.__click=[Cs,K,M,he,F];var gt=a(me,!0);t(me),t($e),f((ze,u,A,$,w,D,Y,Z,Ae,j)=>{bt.disabled=e(W)||e(Pe),Ot(bt,"title",ze),Zt=wa(Yt,1,"",null,Zt,u),Xt.disabled=e(K)===1||e(W),o(Qt,A),o(ta,`${$??""} ${e(K)??""} ${w??""} ${e(M)??""} `),o(ba,` ${D??""} `),o(Da,(e(K)-1)*F+1),o(_,` ${Y??""} `),o(S,Z),o(R,` ${Ae??""} `),o(De,e(z)),me.disabled=e(K)===e(M)||e(W),o(gt,j)},[()=>e(n)?s()("common.refresh",{default:"Refresh"}):"Refresh",()=>({"animate-spin":e(Pe)}),()=>e(n)?s()("pagination.previousShort",{default:"<"}):"<",()=>e(n)?s()("pagination.page",{default:"Page"}):"Page",()=>e(n)?s()("pagination.of",{default:"of"}):"of",()=>e(n)?s()("pagination.resultsSimple",{default:"Results"}):"Results",()=>e(n)?s()("pagination.to",{default:"to"}):"to",()=>Math.min(e(K)*F,e(z)),()=>e(n)?s()("pagination.of",{default:"of"}):"of",()=>e(n)?s()("pagination.nextShort",{default:">"}):">"]),c(ot,$e)};k(ga,ot=>{e(M)>1&&ot(ja)})}f((ot,$e,bt)=>{o(Ya,ot),o(Na,$e),o(fa,bt)},[()=>e(n)?s()("assistants.table.name",{default:"Assistant Name"}):"Assistant Name",()=>e(n)?s()("assistants.table.description",{default:"Description"}):"Description",()=>e(n)?s()("assistants.table.actions",{default:"Actions"}):"Actions"]),c(xe,q)};k(ae,xe=>{e(m).length===0&&e(z)===0?xe(Ne):xe(ge,!1)},ue)}};k(N,ae=>{e(fe)?ae(se):ae(ee,!1)},O)}};k(Re,N=>{e(W)?N(T):N(B,!1)})}t(Le);var H=i(Le,2);{var Q=N=>{};k(H,N=>{v()&&N(Q)})}c(I,_e),lr(),L()}ir(["click"]);const Qr="lamb_assistant_capabilities",es="lamb_assistant_defaults",Hs=60*60*1e3,Kr={systemCapabilities:null,configDefaults:null,loading:!1,error:null,lastLoadedTimestamp:null};function ts(){return console.warn("Using hardcoded fallback defaults"),{config:{system_prompt:"You are a wise surfer dude and a helpful teaching assistant that uses Retrieval-Augmented Generation (RAG) to improve your answers.",prompt_template:`You are a wise surfer dude and a helpful teaching assistant that uses Retrieval-Augmented Generation (RAG) to improve your answers.
This is the user input: {user_input}
This is the context: {context}
Now answer the question:`,prompt_processor:"simple_augment",connector:"openai",llm:"gpt-4o-mini",rag_processor:"no_rag",RAG_Top_k:"3"}}}function as(){return console.warn("Using hardcoded fallback capabilities"),{prompt_processors:["simple_augment"],connectors:{openai:{models:["gpt-4o-mini","gpt-4"]}},rag_processors:["no_rag","simple_rag","single_file_rag"]}}function rs(I){const d=localStorage.getItem(I);if(!d)return null;try{const p=JSON.parse(d);if(Date.now()-p.timestamp<Hs)return p.value}catch(p){console.error(`Error reading cache for ${I}:`,p)}return localStorage.removeItem(I),null}function ss(I,d){try{const p={value:d,timestamp:Date.now()};localStorage.setItem(I,JSON.stringify(p))}catch(p){console.error(`Error setting cache for ${I}:`,p)}}function Ws(){const{subscribe:I,set:d,update:p}=is(Kr);async function L(){var n;console.log("assistantConfigStore: loadConfig called (with caching).");let E=!1;if(p(l=>(E=l.loading,l)),E){console.log("assistantConfigStore: Config load already in progress...");return}console.log("assistantConfigStore: Checking cache...");let s=rs(Qr),v=rs(es);if(s&&v){console.log("assistantConfigStore: Config loaded from cache."),d({systemCapabilities:s,configDefaults:v,loading:!1,error:null,lastLoadedTimestamp:Date.now()});return}p(l=>({...l,loading:!0,error:null})),p(l=>({...Kr,loading:!0,systemCapabilities:s,configDefaults:v})),console.log("assistantConfigStore: Cache miss or expired. Fetching fresh config...");try{if(!s)try{const l=zr(),m=(n=l==null?void 0:l.api)==null?void 0:n.lambServer;if(!m)throw new Error("Lamb server base URL (lambServer) is not configured within config.api.");const W=`${m.replace(/\/$/,"")}/lamb/v1/completions/list`;console.log(`assistantConfigStore: Fetching capabilities from: ${W}`),s=(await Pr.get(W)).data,console.log("Fetched Capabilities (raw):",s),ss(Qr,s)}catch(l){console.error("Error fetching system capabilities:",l),s=as()}if(!v)try{const l="/static/json/defaults.json";console.log(`assistantConfigStore: Fetching defaults from: ${l}`),v=(await Pr.get(l)).data,console.log("Fetched Defaults:",v),ss(es,v)}catch(l){console.error("Error fetching defaults.json:",l),v=ts()}d({systemCapabilities:s,configDefaults:v,loading:!1,error:null,lastLoadedTimestamp:Date.now()})}catch(l){console.error("Error in loadConfig process:",l),p(m=>({...m,systemCapabilities:m.systemCapabilities||as(),configDefaults:m.configDefaults||ts(),loading:!1,error:l instanceof Error?l.message:"Failed to load assistant configuration"}))}}return{subscribe:I,loadConfig:L,reset:()=>{console.log("assistantConfigStore: Resetting store to initial state."),d(Kr)}}}const Ra=Ws();function Ys(I,d,p,L,E){e(d)&&p(e(d)),r(L,""),r(E,""),console.log("Switched back to VIEW mode")}async function Zs(I,d,p,L,E){console.log("Connector changed to:",e(d)),p(),await Va(),e(L).includes(e(E))||(r(E,e(L).length>0?e(L)[0]:"",!0),console.log("Resetting LLM to:",e(E)))}function Xs(){var I;(I=document.getElementById("import-assistant-json"))==null||I.click()}var Qs=g(" <!>",1),eo=g('<div><button type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path></svg> </button></div>'),to=g('<div class="mt-3 p-3 border border-red-200 bg-red-50 rounded-md"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-red-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-red-800"> </h3> <p class="mt-1 text-sm text-red-700"> </p></div></div></div>'),ao=g('<p class="text-center text-gray-600 py-10"> </p>'),ro=g('<p class="text-center text-red-600 py-10"> </p>'),so=g('<p class="text-center text-gray-600 py-10"> </p>'),oo=g('<input type="text" id="assistant-name" name="name" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-gray-100 rounded-md shadow-sm focus:outline-none focus:ring-brand focus:border-brand sm:text-sm">'),io=g('<input type="text" id="assistant-name" name="name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-brand focus:border-brand sm:text-sm">'),no=(I,d,p)=>d(e(p)),lo=g('<button type="button" class="ml-1 px-2 py-0.5 text-xs bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-brand-500"> </button>'),co=g('<div class="mt-2 p-3 bg-gray-50 border border-gray-200 rounded text-sm"><div class="text-xs text-gray-500 mb-1"> </div> <div class="whitespace-pre-wrap" data-testid="prompt-preview"><!></div></div>'),uo=g('<p class="mt-1 text-xs text-gray-500"> </p>'),po=g(`<div class="mb-3"><label class="inline-flex items-center cursor-pointer"><input type="checkbox" class="sr-only peer"> <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div> <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"> </span></label></div>`),fo=g("<option> </option>"),vo=g('<div><label for="prompt-processor" class="block text-sm font-medium text-gray-700"> </label> <select id="prompt-processor" name="prompt_processor" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-brand focus:border-brand sm:text-sm"></select></div>'),go=g("<option> </option>"),mo=g('<div><label for="connector" class="block text-sm font-medium text-gray-700"> </label> <select id="connector" name="connector" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-brand focus:border-brand sm:text-sm"></select></div>'),bo=g("<option> </option>"),_o=g("<option disabled> </option>"),ho=g("<option> </option>"),xo=g('<div><label for="rag-top-k" class="block text-sm font-medium text-gray-700"> </label> <input type="number" id="rag-top-k" name="RAG_Top_k" min="1" max="10" class="mt-1 block w-24 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-brand focus:border-brand sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"> <p class="mt-1 text-xs text-gray-500"> </p></div>'),yo=g('<p class="text-sm text-gray-500"> </p>'),wo=g('<p class="text-sm text-red-600"> </p>'),ko=g('<p class="text-sm text-gray-500"> </p>'),Ao=g('<label class="flex items-center space-x-2 cursor-pointer"><input type="checkbox" class="rounded border-gray-300 text-brand shadow-sm focus:border-brand focus:ring focus:ring-offset-0 focus:ring-brand focus:ring-opacity-50"> <span class="text-sm text-gray-700"> </span></label>'),Eo=g('<div class="mt-2 space-y-2 max-h-48 overflow-y-auto border rounded p-2" role="group" aria-labelledby="kb-group-label"><span id="kb-group-label" class="sr-only"> </span> <!></div>'),Co=g('<div><h4 class="block text-sm font-medium text-gray-700 mb-1"> </h4> <!></div>'),$o=g('<span class="ml-2 text-sm text-gray-500"> </span>'),So=g('<p class="mt-1 text-sm text-red-600"> </p>'),Io=g('<p class="text-sm text-gray-500"> </p>'),No=g('<p class="text-sm text-red-600"> </p>'),Do=g('<p class="text-sm text-gray-500"> </p>'),To=g('<label><input type="radio" name="file-selector" class="h-4 w-4 text-brand rounded focus:ring-brand"> <span class="text-sm text-gray-700"> </span></label>'),Po=g('<p class="mt-1 text-xs text-red-500"> </p>'),Fo=g('<div class="mt-2 space-y-2 max-h-48 overflow-y-auto border rounded p-2"></div> <!>',1),Lo=g(`<div><h4 class="block text-sm font-medium text-gray-700 mb-1"> </h4> <div class="mb-4"><label for="file-upload" class="block text-sm text-gray-700"> </label> <div class="mt-1 flex items-center"><input id="file-upload" type="file" accept=".txt,.json,.md,.pdf,.doc,.docx" class="block w-full text-sm text-gray-500
														file:mr-4 file:py-2 file:px-4
														file:rounded-md file:border-0
														file:text-sm file:font-semibold
														file:bg-gray-50 file:text-gray-700
														hover:file:bg-gray-100 disabled:cursor-not-allowed"> <!></div> <!></div> <!></div>`),Ro=g('<div class="pt-4 border-t border-gray-200 space-y-4"><h4 class="text-md font-medium text-gray-700"> </h4> <!> <!> <!></div>'),Mo=g('<p class="text-sm text-red-600 mt-4 p-2 border border-red-200 bg-red-50 rounded"> </p>'),Bo=g('<p class="text-sm text-green-600 mt-4 p-2 border border-green-200 bg-green-50 rounded"> </p>'),Uo=g('<button type="button" class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"> </button>'),Oo=g('<form class="space-y-6" id="assistant-form-main"><div class="flex flex-col md:flex-row md:space-x-6"><div class="md:w-2/3 space-y-6"><div><label for="assistant-name" class="block text-sm font-medium text-gray-700"> <span class="text-red-600">*</span></label> <!></div> <div><label for="assistant-description" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1 flex rounded-md shadow-sm"><textarea id="assistant-description" name="description" rows="3" class="flex-1 block w-full px-3 py-2 border border-blue-300 rounded-l-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white"></textarea> <button type="button" class="relative -ml-px inline-flex items-center space-x-2 rounded-r-md border border-gray-300 bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand disabled:opacity-50 disabled:cursor-not-allowed"><span> </span></button></div> <p class="mt-1 text-xs text-gray-500"> </p></div> <div><label for="system-prompt" class="block text-sm font-medium text-gray-700"> </label> <textarea id="system-prompt" name="system_prompt" rows="4" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-brand focus:border-brand sm:text-sm"></textarea></div> <div><label for="prompt-template" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1 mb-2"><span class="text-xs text-gray-600 dark:text-gray-400"> </span> <!></div> <textarea id="prompt_template" rows="6" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white"></textarea> <!> <!></div></div> <div class="md:w-1/3"><!> <fieldset class="border p-4 rounded-md space-y-4 h-full"><legend class="text-lg font-medium text-brand px-1"> </legend> <!> <!> <div><label for="llm" class="block text-sm font-medium text-gray-700"> </label> <select id="llm" name="llm" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-brand focus:border-brand sm:text-sm rounded-md"><!></select></div> <div><label for="rag-processor" class="block text-sm font-medium text-gray-700"> </label> <select id="rag-processor" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-brand focus:border-brand sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"></select></div> <!></fieldset></div></div> <!> <!> <div class="pt-5"><div class="flex justify-end space-x-3"><!> <button type="submit" form="assistant-form-main" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-brand hover:bg-brand-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand disabled:opacity-50 disabled:cursor-not-allowed" style="background-color: #2271b3;"><!></button></div></div></form>'),jo=g('<div class="p-4 md:p-6 border rounded-md shadow-sm bg-white"><div class="mb-6 pb-4 border-b border-gray-200"><div class="flex justify-between items-center"><h2 class="text-2xl font-semibold text-brand"><!></h2> <!></div> <!></div> <!> <input type="file" id="import-assistant-json" accept=".json" style="display: none;"></div>');function os(I,d){nr(d,!0);const[p,L]=yr(),E=()=>ka(Ra,"$assistantConfigStore",p),s=()=>ka(wr,"$_",p),v=[],n=[];console.log("AssistantForm.svelte: Initializing script...");const l=ns();let m=Ft(d,"assistant",3,null),W=Ft(d,"startInEdit",3,!1);console.log(`[AssistantForm] Received props: assistant=${!!m()}, startInEdit=${W()}`);let fe=m()?"edit":"create";console.log(`[AssistantForm] Calculated initialMode: ${fe}`);let F=b(It(fe)),K=b(null),z=b(""),M=b(""),je=b(""),ye=b(""),Pe=b(3),he=b(!1),X=b(It([])),ve=b(It([])),re=b(It([])),Fe=b(It([])),Ce=b(""),we=b(""),le=b(""),J=b(""),be=b(It([])),_e=b(It([])),Le=b(!1),Re=b(""),T=b(!1),B=b(It([])),H=b(""),Q=b(!1),N=b(""),O=b(!1),se=b(""),ee=b(!1),ae=b(""),ue=b(!1),Ne=b(!1),ge=b(!1),xe=b(""),q=b(""),ie=b(null),Se=b(It([]));const Wt="e.g. Use the {context} to answer the question: {user_input}";function Aa(u){return e(F)==="create",!0}function Ea(u){if(!u)return"";let A=u;A=A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");for(const $ of e(Se)){const w=$.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");A=A.replace(new RegExp(w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),`<span class="bg-blue-100 text-blue-800 font-medium px-1 rounded">${w}</span>`)}return A}Oa(()=>{var $,w;console.log("AssistantForm.svelte: $effect (assistant prop) running...");const u=(($=m())==null?void 0:$.id)!==((w=e(K))==null?void 0:w.id),A=m()===null&&e(K)!==null||m()!==null&&e(K)===null;u||A?(console.log(`[AssistantForm] Assistant change detected (ID changed: ${u}, Null status changed: ${A})`),m()?(console.log("[AssistantForm] Assistant prop received or changed:",m()),console.log("Assistant prop received or changed:",m()),r(K,{...m()},!0),console.log("Stored initial assistant data:",e(K)),r(F,"edit"),console.log(`Initial formState set to: ${e(F)}`),jt(m()),r(ae,""),r(xe,"")):(console.log("No assistant prop, setting create mode."),r(F,"create"),r(K,null),e(ge)&&Ya())):m()&&(console.log("Assistant reference changed, repopulating fields (preserving description)."),jt(m(),!0))}),vs(()=>(!e(ge)&&!E().loading&&!E().systemCapabilities&&(console.log("AssistantForm.svelte: $effect.pre - Explicitly calling loadConfig()..."),Ra.loadConfig()),Ra.subscribe(A=>{if(!A.loading&&A.systemCapabilities&&A.configDefaults&&!e(ge)){const $=A.systemCapabilities;console.log("Populating dropdown options from capabilities..."),r(X,$.prompt_processors||[],!0),r(ve,Object.keys($.connectors||{}),!0),r(Fe,$.rag_processors||[],!0),r(ge,!0),e(F)==="create"?(console.log("Applying defaults for CREATE mode..."),Ya()):(console.log("Config loaded for VIEW/EDIT mode. Repopulating fields."),jt(e(K)))}})));function Ya(){var $,w;const u=(($=tr(Ra).configDefaults)==null?void 0:$.config)||{};r(je,u.system_prompt||"",!0),r(ye,u.prompt_template||"",!0),r(Pe,parseInt(u.RAG_Top_k||"3",10)||3,!0),r(Ce,u.prompt_processor||(e(X).length>0?e(X)[0]:""),!0),r(we,u.connector||(e(ve).length>0?e(ve)[0]:""),!0);let A=(w=u.rag_processor)==null?void 0:w.trim().toLowerCase();A==="no rag"&&(A="no_rag"),r(J,A||(e(Fe).length>0?e(Fe)[0]:""),!0);try{r(Se,Array.isArray(u.rag_placeholders)?u.rag_placeholders:["{context}","{user_input}"],!0)}catch(D){console.warn("Could not load rag_placeholders from config, using defaults:",D),r(Se,["{context}","{user_input}"],!0)}pa(),r(le,u.llm||(e(re).length>0?e(re)[0]:""),!0),r(_e,[],!0),r(H,""),console.log("Form reset to defaults for CREATE:",{selectedPromptProcessor:e(Ce),selectedConnector:e(we),selectedLlm:e(le),selectedRagProcessor:e(J)}),e(J)==="simple_rag"&&Va().then(fa),e(J)==="single_file_rag"&&Va().then(va)}function jt(u,A=!1){var $,w,D;if(u){if(console.log("Populating form fields from:",u),r(z,(($=u.name)==null?void 0:$.replace(/^\d+_/,""))||"",!0),A||r(M,u.description||"",!0),r(je,u.system_prompt||"",!0),r(ye,u.prompt_template||"",!0),r(Pe,u.RAG_Top_k??3,!0),e(ge)){r(Ce,u.prompt_processor||(e(X).length>0?e(X)[0]:""),!0),r(we,u.connector||(e(ve).length>0?e(ve)[0]:""),!0),r(J,u.rag_processor||(e(Fe).length>0?e(Fe)[0]:""),!0),pa(),r(le,u.llm||(e(re).length>0?e(re)[0]:""),!0),r(_e,((w=u.RAG_collections)==null?void 0:w.split(",").filter(Boolean))||[],!0);const Y=((D=tr(Ra).configDefaults)==null?void 0:D.config)||{};try{r(Se,Array.isArray(Y.rag_placeholders)?Y.rag_placeholders:["{context}","{user_input}"],!0)}catch(Z){console.warn("Could not load rag_placeholders from config in edit mode, using defaults:",Z),r(Se,["{context}","{user_input}"],!0)}e(J)==="simple_rag"&&!e(T)&&!e(Le)&&(console.log("Populate: Triggering KB fetch"),Va().then(fa))}console.log("Form fields populated:",{name:e(z),description:e(M),selectedPromptProcessor:e(Ce),selectedConnector:e(we),selectedLlm:e(le),selectedRagProcessor:e(J)})}}function Na(u){return u?Array.isArray(u.models)?u.models:Array.isArray(u.available_llms)?u.available_llms:typeof u.models=="object"&&u.models!==null?Object.keys(u.models):[]:[]}function pa(){const u=tr(Ra);if(!u||!u.systemCapabilities||!u.systemCapabilities.connectors){r(re,[],!0);return}const A=u.systemCapabilities.connectors[e(we)];r(re,Na(A),!0)}async function fa(){if(e(Le)||e(T)){console.log(`Skipping KB fetch (Loading: ${e(Le)}, Attempted: ${e(T)})`);return}if(e(J)!=="simple_rag"){console.log("Skipping KB fetch (RAG processor is not simple_rag)");return}console.log("Fetching knowledge bases..."),r(Le,!0),r(Re,"");try{const u=await cs();u.sort((A,$)=>A.name.localeCompare($.name)),r(be,u,!0)}catch(u){console.error("Error fetching knowledge bases:",u),r(Re,u instanceof Error?u.message:"Failed to load knowledge bases",!0),r(be,[],!0)}finally{r(Le,!1),r(T,!0),console.log(`KB Fetch complete (Attempted: ${e(T)}, Error: '${e(Re)}', Count: ${e(be).length})`)}}async function va(){var u,A,$,w;if(e(Q)){console.log("Skipping files fetch (already loading)");return}console.log("Fetching user files..."),r(Q,!0),r(N,"");try{const D=ja();if(!D)throw new Error("Authentication token not found");const Y=(A=(u=window.LAMB_CONFIG)==null?void 0:u.api)==null?void 0:A.lambServer;if(!Y)throw new Error("LAMB server URL not configured in window.LAMB_CONFIG.api.lambServer");const Ae=`${Y.replace(/\/$/,"")}/creator/files/list`,j=await fetch(Ae,{headers:{Authorization:`Bearer ${D}`}});if(!j.ok){const V=await j.text();throw new Error(`API error: ${j.status} - ${V||"Unknown error"}`)}const U=await j.json();r(B,U,!0);const G=(($=m())==null?void 0:$.metadata)||((w=m())==null?void 0:w.api_callback);if(G)try{const V=JSON.parse(G);V.file_path&&e(B).some(Ie=>Ie.path===V.file_path)&&r(H,V.file_path,!0)}catch(V){console.error("Error parsing metadata for file path:",V)}console.log(`Fetched ${e(B).length} files`)}catch(D){console.error("Error fetching user files:",D),r(N,D instanceof Error?D.message:"Failed to load files",!0),r(B,[],!0)}finally{r(Q,!1),r(ee,!0)}}async function ga(u){var w,D;const A=u.target;if(!A||!(A instanceof HTMLInputElement)||!A.files||A.files.length===0)return;const $=A.files[0];if($){r(O,!0),r(se,"");try{const Y=ja();if(!Y)throw new Error("Authentication token not found");const Z=(D=(w=window.LAMB_CONFIG)==null?void 0:w.api)==null?void 0:D.lambServer;if(!Z)throw new Error("LAMB server URL not configured");const Ae=new FormData;Ae.append("file",$);const U=`${Z.replace(/\/$/,"")}/creator/files/upload`,G=await fetch(U,{method:"POST",headers:{Authorization:`Bearer ${Y}`},body:Ae});if(!G.ok){const Ie=await G.text();throw new Error(`API error: ${G.status} - ${Ie||"Unknown error"}`)}const V=await G.json();console.log("File uploaded successfully:",V),await va(),V.path&&r(H,V.path,!0),A.value=""}catch(Y){console.error("Error uploading file:",Y),r(se,Y instanceof Error?Y.message:"Failed to upload file",!0)}finally{r(O,!1)}}}function ja(){if(typeof localStorage<"u"){const u=localStorage.getItem("userToken");if(u)return console.debug("Auth token found in localStorage"),u}return console.debug("Token not found in localStorage, checking cookie"),document.cookie.replace(/(?:(?:^|.*;\\s*)token\\s*=\\s*([^;]*).*$)|^.*$/,"$1")}async function ot(){var $,w;if(!e(z).trim()){alert(s()("assistants.form.description.nameRequired",{default:"Please provide an assistant name first"}));return}const u=ja();if(console.debug("Auth token found:",u?"Yes (length: "+u.length+")":"No"),!u){console.error("Authentication token not found"),alert(s()("assistants.form.description.authError",{default:"Authentication error. Please try logging in again."}));return}r(Ne,!0);let A="";try{const D=(w=($=window.LAMB_CONFIG)==null?void 0:$.api)==null?void 0:w.lambServer;if(!D)throw new Error("LAMB server URL not configured in window.LAMB_CONFIG.api.lambServer");const Y=new AbortController,Z=setTimeout(()=>Y.abort(),15e3),j=`${D.replace(/\/$/,"")}/creator/assistant/generate_assistant_description`;console.debug("Calling generate_assistant_description at URL:",j);const U={name:e(z),instructions:e(je)||"",prompt_template:e(ye)||"",connector:e(we)||"",llm:e(le)||"",rag_processor:e(J)||""},G=await fetch(j,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(U),signal:Y.signal});if(clearTimeout(Z),!G.ok){const Ie=await G.text();throw console.error("API error response:",Ie),G.status===403||G.status===401?new Error(`Authentication error (${G.status}): Please try logging in again.`):new Error(`API error: ${G.status} - ${Ie||"Unknown error"}`)}const V=await G.json();if(V.description){let Ie=V.description.trim().replace(/^["']|["']$/g,"");Ie.length>500&&(Ie=Ie.substring(0,497)+"..."),r(M,Ie,!0),console.log("Description generated successfully")}else throw new Error(V.error||"Failed to generate description")}catch(D){console.error("Error generating description:",D),D instanceof Error&&D.name==="AbortError"?A=s()("assistants.form.description.timeout",{default:"Request timed out. Please try again."}):A=D instanceof Error?D.message:s()("assistants.form.description.error",{default:"Failed to generate description"}),alert(A)}finally{r(Ne,!1)}}const $e=Ua(()=>e(J)&&e(J)!=="no_rag"),bt=Ua(()=>e(J)==="simple_rag"),Yt=Ua(()=>e(J)==="single_file_rag");Oa(()=>{console.log(`Effect: RAG processor changed to ${e(J)}`),e(J)==="simple_rag"&&e(ge)?(console.log(`Effect: Checking KB fetch need (Attempted: ${e(T)})`),!e(T)&&!e(Le)?(console.log("Effect: Conditions met (simple_rag, not attempted), calling fetchKnowledgeBases()"),fa()):console.log("Effect: Skipping KB fetch (already attempted or loading).")):e(J)==="single_file_rag"&&e(ge)?!e(ee)&&!e(Q)?(console.log("Effect: Conditions met (single_file_rag, not attempted), calling fetchUserFiles()"),va()):console.log("Effect: Skipping files fetch (already attempted or loading)."):((e(be).length>0||e(_e).length>0||e(Re)||e(T))&&(console.log("Effect: Clearing KB state and fetch attempt flag"),r(be,[],!0),r(_e,[],!0),r(Re,""),r(T,!1)),e(J)!=="single_file_rag"&&(e(H)||e(B).length>0)&&r(H,""))});async function Zt(u){var w,D,Y;if(u.preventDefault(),r(ae,""),r(xe,""),r(ue,!0),!((w=e(z))!=null&&w.trim())){r(ae,"Assistant Name is required."),r(ue,!1);return}if(e(F)==="create"&&!e(he)){const Z=((D=tr(Ra).configDefaults)==null?void 0:D.config)||{};r(Ce,Z.prompt_processor||(e(X).length>0?e(X)[0]:""),!0),r(we,Z.connector||(e(ve).length>0?e(ve)[0]:""),!0),await Va(),pa(),e(re).includes(e(le))||r(le,Z.llm||(e(re).length>0?e(re)[0]:""),!0)}const A={prompt_processor:e(Ce),connector:e(we),llm:e(le),rag_processor:e(J),file_path:e(J)==="single_file_rag"?e(H):""},$={name:e(z).trim(),description:e(M),system_prompt:e(je),prompt_template:e(ye),RAG_Top_k:Number(e(Pe))||3,RAG_collections:e(J)==="simple_rag"?e(_e).join(","):"",metadata:JSON.stringify(A),pre_retrieval_endpoint:"",post_retrieval_endpoint:"",RAG_endpoint:""};try{let Z;if(e(F)==="edit"&&((Y=e(K))!=null&&Y.id)){console.log("Submitting UPDATE for assistant:",e(K).id,$);const Ae=await ws(e(K).id.toString(),$);r(xe,"Assistant updated successfully!"),r(K,{...e(K),...$},!0),jt(e(K)),l("formSuccess",{assistantId:e(K).id})}else if(e(F)==="create"){const Ae=await us($);if(!(Ae!=null&&Ae.assistant_id))throw new Error("Create assistant response did not include an assistant_id.");r(xe,"Assistant created successfully!"),l("formSuccess",{assistantId:Ae.assistant_id})}else throw new Error("Invalid form state for submission.")}catch(Z){console.error(`Error ${e(F)==="edit"?"updating":"creating"} assistant:`,Z),r(ae,Z instanceof Error?Z.message:`Failed to ${e(F)==="edit"?"update":"create"} assistant`,!0),r(xe,"")}finally{r(ue,!1)}}function ma(u){const A=u.target,$=A.files;r(q,"");let w=["Starting validation..."];if($&&$.length>0){const D=$[0];if(console.log("Selected file:",D.name,D.type,D.size),D.type!=="application/json"&&!D.name.toLowerCase().endsWith(".json")){r(q,s()("assistants.form.import.invalidFile",{default:"Invalid file type. Please select a .json file."}),!0),console.error(e(q)),A.value="";return}const Y=new FileReader;Y.onload=async Z=>{var j,U,G,V,Ie,Nt,Me,We;const Ae=(j=Z.target)==null?void 0:j.result;if(typeof Ae=="string"){console.log("--- Imported Assistant JSON Content ---"),console.log("-------------------------------------");let oe;try{oe=JSON.parse(Ae),w.push(" JSON parsed successfully.")}catch(Ge){w.push(` Invalid JSON format: ${Ge instanceof Error?Ge.message:"Unknown JSON error"}`),oe=null}let te=null;if(oe&&typeof oe=="object"){const qe=tr(Ra).systemCapabilities;if(!qe)w.push(" System capabilities not loaded. Skipping detailed validation.");else{w.push(" System capabilities loaded. Performing detailed checks...");const Lt=["name","system_prompt","metadata"];for(const Ye of Lt)Ye in oe||w.push(` Missing required field: ${Ye}`);const Je=oe.metadata||oe.api_callback;if(Je&&typeof Je=="string")try{if(te=JSON.parse(Je),w.push(" Parsed metadata successfully."),te.prompt_processor&&!((U=qe.prompt_processors)!=null&&U.includes(te.prompt_processor))&&w.push(` Invalid prompt_processor: ${te.prompt_processor}. Available: ${(G=qe.prompt_processors)==null?void 0:G.join(", ")}`),te.connector&&!((V=qe.connectors)!=null&&V[te.connector]))w.push(` Invalid connector: ${te.connector}. Available: ${Object.keys(qe.connectors||{}).join(", ")}`);else if(te.connector&&te.llm){const Ye=(Ie=qe.connectors)==null?void 0:Ie[te.connector];if(Ye){const ht=Na(Ye);ht.includes(te.llm)||w.push(` Invalid llm for connector ${te.connector}: ${te.llm}. Available: ${ht.join(", ")}`)}else w.push(` Could not retrieve capabilities for connector ${te.connector}.`)}te.rag_processor&&!((Nt=qe.rag_processors)!=null&&Nt.includes(te.rag_processor))&&w.push(` Invalid rag_processor: ${te.rag_processor}. Available: ${(Me=qe.rag_processors)==null?void 0:Me.join(", ")}`),te.rag_processor==="single_file_rag"&&!te.file_path&&w.push(" Missing file_path in metadata for single_file_rag processor.")}catch(Ye){w.push(` Error parsing metadata JSON: ${Ye instanceof Error?Ye.message:"Unknown error"}`)}else w.push(" metadata field is missing or not a string.");(te==null?void 0:te.rag_processor)==="simple_rag"&&((oe.RAG_Top_k===void 0||typeof oe.RAG_Top_k!="number")&&w.push(` RAG_Top_k is missing or not a number (Required for simple_rag). Found: ${typeof oe.RAG_Top_k}`),(oe.RAG_collections===void 0||typeof oe.RAG_collections!="string")&&w.push(` RAG_collections is missing or not a string (Required for simple_rag). Found: ${typeof oe.RAG_collections}`))}}else oe!==null&&w.push(" Imported data is not a valid JSON object.");if(console.log("--- Assistant Import Validation Results ---"),w.forEach(Ge=>console.log(Ge)),console.log("-------------------------------------------"),!w.some(Ge=>Ge.startsWith(""))&&oe&&te)try{w.push(" Populating form fields..."),r(z,oe.name||"",!0),r(M,oe.description||"",!0),r(je,oe.system_prompt||"",!0),r(ye,oe.prompt_template||"",!0),r(Pe,oe.RAG_Top_k??3,!0),r(Ce,te.prompt_processor||(e(X).length>0?e(X)[0]:""),!0),r(we,te.connector||(e(ve).length>0?e(ve)[0]:""),!0),r(J,te.rag_processor||(e(Fe).length>0?e(Fe)[0]:""),!0),pa(),await Va(),e(re).includes(te.llm)?r(le,te.llm,!0):(r(le,e(re).length>0?e(re)[0]:"",!0),w.push(` Imported LLM '${te.llm}' not available for connector '${e(we)}'. Defaulting to '${e(le)}'.`)),e(J)==="simple_rag"?(r(_e,((We=oe.RAG_collections)==null?void 0:We.split(",").filter(Boolean))||[],!0),r(H,""),e(T)||fa()):e(J)==="single_file_rag"?(r(H,te.file_path||"",!0),r(_e,[],!0),e(ee)||va()):(r(_e,[],!0),r(H,"")),w.push(" Form fields populated successfully."),r(q,""),r(xe,s()("assistants.form.import.success",{default:"Assistant data imported successfully! Please review and save."}),!0),setTimeout(()=>{r(xe,"")},5e3)}catch(Ge){w.push(` Error populating form: ${Ge instanceof Error?Ge.message:"Unknown population error"}`),r(q,s()("assistants.form.import.populationError",{default:"Error populating form from imported data. Check console."}),!0)}else r(q,s()("assistants.form.import.validationFailed",{default:"Import validation failed. Form not populated. Check console for details."}),!0)}else console.error("Failed to read file content as string."),r(q,s()("assistants.form.import.readError",{default:"Could not read file content."}),!0),w.push(` ${e(q)}`)},Y.onerror=Z=>{console.error("Error reading file:",Z),r(q,s()("assistants.form.import.fileReadError",{default:"Error reading the selected file."}),!0),w.push(` ${e(q)}`)},Y.readAsText(D)}A.value=""}function Xt(u){if(e(ie)){const A=e(ie).selectionStart,$=e(ie).selectionEnd,w=e(ye);r(ye,w.substring(0,A)+u+w.substring($)),e(ie).focus(),Va().then(()=>{e(ie)&&(e(ie).selectionStart=e(ie).selectionEnd=A+u.length)})}}var Qt=jo(),ea=a(Qt),ta=a(ea),ba=a(ta),aa=a(ba);{var Da=u=>{var A=ua();f($=>o(A,$),[()=>s()("assistants.form.titleCreate",{default:"Create New Assistant"})]),c(u,A)},_=u=>{var A=Qs(),$=He(A),w=i($);{var D=Y=>{var Z=ua();f(()=>o(Z,`(ID: ${e(K).id??""})`)),c(Y,Z)};k(w,Y=>{var Z;(Z=e(K))!=null&&Z.id&&Y(D)})}f(Y=>o($,`${Y??""} `),[()=>s()("assistants.form.titleViewEdit",{default:"Assistant Details"})]),c(u,A)};k(aa,u=>{e(F)==="create"?u(Da):u(_,!1)})}t(ba);var y=i(ba,2);{var S=u=>{var A=eo(),$=a(A);$.__click=[Xs];var w=i(a($));t($),t(A),f(D=>o(w,` ${D??""}`),[()=>s()("assistants.form.import.button",{default:"Import from JSON"})]),c(u,A)};k(y,u=>{e(F)==="create"&&u(S)})}t(ta);var R=i(ta,2);{var P=u=>{var A=to(),$=a(A),w=i(a($),2),D=a(w),Y=a(D,!0);t(D);var Z=i(D,2),Ae=a(Z,!0);t(Z),t(w),t($),t(A),f(j=>{o(Y,j),o(Ae,e(q))},[()=>s()("assistants.form.import.error",{default:"Import Error"})]),c(u,A)};k(R,u=>{e(q)&&u(P)})}t(ea);var De=i(ea,2);{var me=u=>{var A=ao(),$=a(A,!0);t(A),f(w=>o($,w),[()=>s()("assistants.loadingConfig",{default:"Loading configuration..."})]),c(u,A)},gt=(u,A)=>{{var $=D=>{var Y=ro(),Z=a(Y);t(Y),f(Ae=>o(Z,`${Ae??""} ${E().error??""}`),[()=>s()("assistants.errorConfig",{default:"Error loading configuration:"})]),c(D,Y)},w=(D,Y)=>{{var Z=j=>{var U=so(),G=a(U,!0);t(U),f(V=>o(G,V),[()=>s()("assistants.initializingForm",{default:"Initializing form..."})]),c(j,U)},Ae=j=>{var U=Oo(),G=a(U),V=a(G),Ie=a(V),Nt=a(Ie),Me=a(Nt);or(),t(Nt);var We=i(Nt,2);{var oe=h=>{var x=oo();Ma(x),x.disabled=!0,f(C=>Ot(x,"placeholder",C),[()=>s()("assistants.form.name.placeholder")]),Ba(x,()=>e(z),C=>r(z,C)),c(h,x)},te=h=>{var x=io();Ma(x),x.disabled=!1,f(C=>Ot(x,"placeholder",C),[()=>s()("assistants.form.name.placeholder")]),Ba(x,()=>e(z),C=>r(z,C)),c(h,x)};k(We,h=>{e(F)==="edit"?h(oe):h(te,!1)})}t(Ie);var _t=i(Ie,2),Ge=a(_t),qe=a(Ge,!0);t(Ge);var Lt=i(Ge,2),Je=a(Lt);Gr(Je),Je.disabled=!1;var Ye=i(Je,2);Ye.__click=ot;var ht=a(Ye),Ga=a(ht,!0);t(ht),t(Ye),t(Lt);var xt=i(Lt,2),_a=a(xt,!0);t(xt),t(_t);var Gt=i(_t,2),ra=a(Gt),Kt=a(ra,!0);t(ra);var yt=i(ra,2);Gr(yt),yt.disabled=!1,t(Gt);var Ze=i(Gt,2),it=a(Ze),dt=a(it,!0);t(it);var wt=i(it,2),Xe=a(wt),Rt=a(Xe);t(Xe);var Dt=i(Xe,2);ya(Dt,17,()=>e(Se),ar,(h,x)=>{var C=lo();C.__click=[no,Xt,x];var ne=a(C,!0);t(C),f(()=>o(ne,e(x))),c(h,C)}),t(wt);var Qe=i(wt,2);Gr(Qe),Ot(Qe,"placeholder",Wt),ds(Qe,h=>r(ie,h),()=>e(ie));var ct=i(Qe,2);{var ha=h=>{var x=co(),C=a(x),ne=a(C,!0);t(C);var de=i(C,2),ce=a(de);Ha(ce,()=>Ea(e(ye))),t(de),t(x),f(ke=>o(ne,ke),[()=>s()("preview")||"Preview with highlighted placeholders:"]),c(h,x)};k(ct,h=>{e(ye)&&h(ha)})}var ut=i(ct,2);{var Tt=h=>{var x=uo(),C=a(x,!0);t(x),f(ne=>o(C,ne),[()=>s()("assistants.form.promptTemplate.help",{default:"This processor requires a valid prompt template."})]),c(h,x)};k(ut,h=>{e(Ce)==="template_validator_processor"&&h(Tt)})}t(Ze),t(V);var nt=i(V,2),Mt=a(nt);{var Ta=h=>{var x=po(),C=a(x),ne=a(C);Ma(ne);var de=i(ne,4),ce=a(de,!0);t(de),t(C),t(x),f(ke=>o(ce,ke),[()=>s()("assistants.form.advancedMode")||"Advanced Mode"]),ms(ne,()=>e(he),ke=>r(he,ke)),c(h,x)};k(Mt,h=>{e(F)==="create"&&h(Ta)})}var xa=i(Mt,2),sa=a(xa),Ka=a(sa,!0);t(sa);var kr=i(sa,2);{var Ar=h=>{var x=vo(),C=a(x),ne=a(C,!0);t(C);var de=i(C,2);de.disabled=!1,ya(de,21,()=>e(X),ar,(ce,ke)=>{var Be=fo(),At={},Pt=a(Be,!0);t(Be),f(()=>{At!==(At=e(ke))&&(Be.value=(Be.__value=e(ke))??""),o(Pt,e(ke))}),c(ce,Be)}),t(de),t(x),f(ce=>o(ne,ce),[()=>s()("assistants.form.promptProcessor.label",{default:"Prompt Processor"})]),Tr(de,()=>e(Ce),ce=>r(Ce,ce)),c(h,x)};k(kr,h=>{(e(he)||e(F)==="edit")&&h(Ar)})}var Er=i(kr,2);{var dr=h=>{var x=mo(),C=a(x),ne=a(C,!0);t(C);var de=i(C,2);de.__change=[Zs,we,pa,re,le],de.disabled=!1,ya(de,21,()=>e(ve),ar,(ce,ke)=>{var Be=go(),At={},Pt=a(Be,!0);t(Be),f(()=>{At!==(At=e(ke))&&(Be.value=(Be.__value=e(ke))??""),o(Pt,e(ke))}),c(ce,Be)}),t(de),t(x),f(ce=>o(ne,ce),[()=>s()("assistants.form.connector.label",{default:"Connector"})]),Tr(de,()=>e(we),ce=>r(we,ce)),c(h,x)};k(Er,h=>{(e(he)||e(F)==="edit")&&h(dr)})}var za=i(Er,2),cr=a(za),Cr=a(cr,!0);t(cr);var Za=i(cr,2),ur=a(Za);{var pr=h=>{var x=_r(),C=He(x);ya(C,17,()=>e(re),ar,(ne,de)=>{var ce=bo(),ke={},Be=a(ce,!0);t(ce),f(()=>{ke!==(ke=e(de))&&(ce.value=(ce.__value=e(de))??""),o(Be,e(de))}),c(ne,ce)}),c(h,x)},Lr=h=>{var x=_o();x.value=x.__value="";var C=a(x,!0);t(x),f(ne=>o(C,ne),[()=>s()("assistants.form.llm.noneAvailable",{default:"No models available for selected connector"})]),c(h,x)};k(ur,h=>{e(re).length>0?h(pr):h(Lr,!1)})}t(Za),t(za);var Xa=i(za,2),fr=a(Xa),$r=a(fr,!0);t(fr);var Pa=i(fr,2);ya(Pa,21,()=>e(Fe),ar,(h,x)=>{var C=ho(),ne={},de=a(C,!0);t(C),f(ce=>{ne!==(ne=e(x))&&(C.value=(C.__value=e(x))??""),o(de,ce)},[()=>e(x).replace(/_/g," ").replace(/\b\w/g,ce=>ce.toUpperCase())]),c(h,C)}),t(Pa),t(Xa);var Rr=i(Xa,2);{var Sr=h=>{var x=Ro(),C=a(x),ne=a(C,!0);t(C);var de=i(C,2);{var ce=tt=>{var Ve=xo(),at=a(Ve),oa=a(at,!0);t(at);var pt=i(at,2);Ma(pt),pt.disabled=!1;var qt=i(pt,2),ia=a(qt,!0);t(qt),t(Ve),f((Ke,ft)=>{o(oa,Ke),o(ia,ft)},[()=>s()("assistants.form.ragTopK.label",{default:"RAG Top K"}),()=>s()("assistants.form.ragTopK.help",{default:"Number of relevant documents to retrieve (1-10)."})]),Ba(pt,()=>e(Pe),Ke=>r(Pe,Ke)),c(tt,Ve)};k(de,tt=>{e(J)==="simple_rag"&&tt(ce)})}var ke=i(de,2);{var Be=tt=>{var Ve=Co(),at=a(Ve),oa=a(at,!0);t(at);var pt=i(at,2);{var qt=Ke=>{var ft=yo(),na=a(ft,!0);t(ft),f($a=>o(na,$a),[()=>s()("assistants.form.knowledgeBases.loading",{default:"Loading knowledge bases..."})]),c(Ke,ft)},ia=(Ke,ft)=>{{var na=Ut=>{var la=wo(),Sa=a(la);t(la),f(Ia=>o(Sa,`${Ia??""} ${e(Re)??""}`),[()=>s()("assistants.form.knowledgeBases.error",{default:"Error loading knowledge bases:"})]),c(Ut,la)},$a=(Ut,la)=>{{var Sa=Ue=>{var pe=ko(),Ee=a(pe,!0);t(pe),f(Et=>o(Ee,Et),[()=>s()("assistants.form.knowledgeBases.noneFound",{default:"No accessible knowledge bases found."})]),c(Ue,pe)},Ia=Ue=>{var pe=Eo(),Ee=a(pe),Et=a(Ee,!0);t(Ee);var Jt=i(Ee,2);ya(Jt,17,()=>e(be),mt=>mt.id,(mt,Ct)=>{var da=Ao(),Vt=a(da);Ma(Vt);var ca;Vt.disabled=!1;var Oe=i(Vt,2),rt=a(Oe,!0);t(Oe),t(da),f(()=>{ca!==(ca=e(Ct).id)&&(Vt.value=(Vt.__value=e(Ct).id)??""),o(rt,e(Ct).name)}),Wr(v,[],Vt,()=>(e(Ct).id,e(_e)),vt=>r(_e,vt)),c(mt,da)}),t(pe),f(mt=>o(Et,mt),[()=>s()("assistants.form.knowledgeBases.label",{default:"Knowledge Bases"})]),c(Ue,pe)};k(Ut,Ue=>{e(be).length===0?Ue(Sa):Ue(Ia,!1)},la)}};k(Ke,Ut=>{e(Re)?Ut(na):Ut($a,!1)},ft)}};k(pt,Ke=>{e(Le)?Ke(qt):Ke(ia,!1)})}t(Ve),f(Ke=>o(oa,Ke),[()=>s()("assistants.form.knowledgeBases.label",{default:"Knowledge Bases"})]),c(tt,Ve)};k(ke,tt=>{e(bt)&&tt(Be)})}var At=i(ke,2);{var Pt=tt=>{var Ve=Lo(),at=a(Ve),oa=a(at,!0);t(at);var pt=i(at,2),qt=a(pt),ia=a(qt,!0);t(qt);var Ke=i(qt,2),ft=a(Ke);ft.__change=ga;var na=i(ft,2);{var $a=pe=>{var Ee=$o(),Et=a(Ee,!0);t(Ee),f(Jt=>o(Et,Jt),[()=>s()("assistants.form.singleFile.uploading",{default:"Uploading..."})]),c(pe,Ee)};k(na,pe=>{e(O)&&pe($a)})}t(Ke);var Ut=i(Ke,2);{var la=pe=>{var Ee=So(),Et=a(Ee,!0);t(Ee),f(()=>o(Et,e(se))),c(pe,Ee)};k(Ut,pe=>{e(se)&&pe(la)})}t(pt);var Sa=i(pt,2);{var Ia=pe=>{var Ee=Io(),Et=a(Ee,!0);t(Ee),f(Jt=>o(Et,Jt),[()=>s()("assistants.form.singleFile.loading",{default:"Loading files..."})]),c(pe,Ee)},Ue=(pe,Ee)=>{{var Et=mt=>{var Ct=No(),da=a(Ct);t(Ct),f(Vt=>o(da,`${Vt??""} ${e(N)??""}`),[()=>s()("assistants.form.singleFile.error",{default:"Error loading files:"})]),c(mt,Ct)},Jt=(mt,Ct)=>{{var da=ca=>{var Oe=Do(),rt=a(Oe,!0);t(Oe),f(vt=>o(rt,vt),[()=>s()("assistants.form.singleFile.noneFound",{default:"No files found. Please upload a file."})]),c(ca,Oe)},Vt=ca=>{var Oe=Fo(),rt=He(Oe);ya(rt,21,()=>e(B),$t=>$t.path,($t,St)=>{var Ht=To(),st=a(Ht);Ma(st);var Fa;st.disabled=!1;var Qa=i(st,2),mr=a(Qa,!0);t(Qa),t(Ht),f(()=>{wa(Ht,1,`flex items-center space-x-2 p-1 cursor-pointer ${e(H)===e(St).path?"bg-blue-50":"hover:bg-gray-50"}`),Fa!==(Fa=e(St).path)&&(st.value=(st.__value=e(St).path)??""),o(mr,e(St).name)}),Wr(n,[],st,()=>(e(St).path,e(H)),La=>r(H,La)),c($t,Ht)}),t(rt);var vt=i(rt,2);{var qa=$t=>{var St=Po(),Ht=a(St,!0);t(St),f(st=>o(Ht,st),[()=>s()("assistants.form.singleFile.required",{default:"Please select a file"})]),c($t,St)};k(vt,$t=>{!e(H)&&e(F)==="edit"&&$t(qa)})}c(ca,Oe)};k(mt,ca=>{e(B).length===0?ca(da):ca(Vt,!1)},Ct)}};k(pe,mt=>{e(N)?mt(Et):mt(Jt,!1)},Ee)}};k(Sa,pe=>{e(Q)?pe(Ia):pe(Ue,!1)})}t(Ve),f((pe,Ee)=>{o(oa,pe),o(ia,Ee),ft.disabled=e(O)},[()=>s()("assistants.form.singleFile.label",{default:"Select File"}),()=>s()("assistants.form.singleFile.upload",{default:"Upload New File"})]),c(tt,Ve)};k(At,tt=>{e(Yt)&&tt(Pt)})}t(x),f(tt=>o(ne,tt),[()=>s()("assistants.form.ragOptions.title",{default:"RAG Options"})]),c(h,x)};k(Rr,h=>{e($e)&&h(Sr)})}t(xa),t(nt),t(G);var Ir=i(G,2);{var Mr=h=>{var x=Mo(),C=a(x);t(x),f(()=>o(C,`Error: ${e(ae)??""}`)),c(h,x)};k(Ir,h=>{e(ae)&&h(Mr)})}var Nr=i(Ir,2);{var Te=h=>{var x=Bo(),C=a(x,!0);t(x),f(()=>o(C,e(xe))),c(h,x)};k(Nr,h=>{e(xe)&&e(F)!=="edit"&&h(Te)})}var et=i(Nr,2),kt=a(et),zt=a(kt);{var Bt=h=>{var x=Uo();x.__click=[Ys,K,jt,ae,xe];var C=a(x,!0);t(x),f(ne=>{x.disabled=e(ue),o(C,ne)},[()=>s()("common.cancel",{default:"Cancel"})]),c(h,x)};k(zt,h=>{e(F)==="edit"&&h(Bt)})}var lt=i(zt,2),Ca=a(lt);{var vr=h=>{var x=ua();f(C=>o(x,C),[()=>e(ue)?s()("common.saving",{default:"Saving..."}):s()("common.save",{default:"Save"})]),c(h,x)},gr=h=>{var x=ua();f(C=>o(x,C),[()=>e(ue)?s()("common.saving",{default:"Saving..."}):s()("common.saveChanges",{default:"Save Changes"})]),c(h,x)};k(Ca,h=>{e(F)==="create"?h(vr):h(gr,!1)})}t(lt),t(kt),t(et),t(U),f((h,x,C,ne,de,ce,ke,Be,At,Pt,tt,Ve,at)=>{o(Me,`${h??""} `),o(qe,x),Ot(Je,"placeholder",C),Ye.disabled=e(Ne),o(Ga,ne),o(_a,de),o(Kt,ce),Ot(yt,"placeholder",ke),o(dt,Be),o(Rt,`${At??""}:`),Qe.disabled=Pt,o(Ka,tt),o(Cr,Ve),Za.disabled=e(re).length===0,o($r,at),Pa.disabled=e(F)==="edit",lt.disabled=e(ue)||e(F)==="create"&&!E().systemCapabilities},[()=>s()("assistants.form.name.label"),()=>s()("assistants.form.description.label",{default:"Description"}),()=>s()("assistants.form.description.placeholder",{default:"A brief summary of the assistant"}),()=>e(Ne)?s()("assistants.form.description.generating",{default:"Generating..."}):s()("assistants.form.description.generateButton",{default:"Generate"}),()=>s()("assistants.form.description.help",{default:"Click Generate after filling in name and prompts."}),()=>s()("assistants.form.systemPrompt.label",{default:"System Prompt"}),()=>s()("assistants.form.systemPrompt.placeholder",{default:"Define the assistant's role and personality..."}),()=>s()("assistants.form.promptTemplate.label",{default:"Prompt Template"}),()=>s()("insert_placeholder")||"Insert placeholder:",()=>!Aa(),()=>s()("assistants.form.configSection.title",{default:"Configuration"}),()=>s()("assistants.form.llm.label",{default:"Language Model (LLM)"}),()=>s()("assistants.form.ragProcessor.label")]),Fr("submit",U,Zt),Ba(Je,()=>e(M),h=>r(M,h)),Ba(yt,()=>e(je),h=>r(je,h)),Ba(Qe,()=>e(ye),h=>r(ye,h)),Tr(Za,()=>e(le),h=>r(le,h)),Tr(Pa,()=>e(J),h=>r(J,h)),c(j,U)};k(D,j=>{e(ge)?j(Ae,!1):j(Z)},Y)}};k(u,D=>{E().error?D($):D(w,!1)},A)}};k(De,u=>{E().loading&&!e(ge)?u(me):u(gt,!1)})}var ze=i(De,2);ze.__change=ma,t(Qt),c(I,Qt),lr(),L()}ir(["click","change"]);var Go=g('<span class="italic"> </span>'),Ko=g('<p class="whitespace-pre-wrap"> </p>'),zo=g("<div><div><!></div></div>"),qo=g('<div class="flex justify-start"><div class="max-w-xs md:max-w-md lg:max-w-lg xl:max-w-xl px-4 py-2 rounded-lg shadow bg-gray-200 text-gray-800 italic">Thinking...</div></div>'),Jo=xr('<svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Vo=g('<div class="flex flex-col h-full chat-max-height border border-gray-300 rounded-md overflow-hidden shadow-sm svelte-18hjw8q"><div class="p-2 border-b border-gray-200 bg-gray-50 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-700">Chat</h2> <!></div> <div class="flex-grow p-4 overflow-y-auto space-y-4 bg-white"><!> <!></div> <div class="p-3 border-t border-gray-200 bg-gray-50"><form class="flex items-center space-x-2"><input type="text" placeholder="Type your message..." class="flex-grow border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100"> <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></form></div></div>');function Ho(I,d){nr(d,!0);let p=Ft(d,"apiUrl",3,""),L=Ft(d,"apiKey",3,""),E=Ft(d,"initialModel",3,null),s=Ft(d,"assistantId",3,null),v=b(It([])),n=b(""),l=b(!1),m=b(It([])),W=b(It(E()??"gpt-3.5-turbo")),fe=b(!1),F=b(null),K=b(!1),z=b(null);function M(T){const B=new Date().toISOString().split("T")[1].replace("Z","");console.log(`[${B}] CHAT: ${T}`)}async function je(){if(!p()||!L()){r(F,"API URL or API Key is not configured."),console.error(e(F));return}r(fe,!0),r(F,null),M(`Fetching models from ${p()}/models`);try{const T=await fetch(`${p()}/models`,{method:"GET",headers:{Authorization:`Bearer ${L()}`}});if(!T.ok)throw new Error(`Failed to fetch models: ${T.status}`);const B=await T.json();if(B.data&&Array.isArray(B.data)){const H=B.data.map(Q=>Q.id).sort();if(r(m,H,!0),M(`Models loaded: ${H.join(", ")}`),H.length>0&&(!e(W)||!H.includes(e(W)))){if(E()&&H.includes(E()))r(W,E());else{const Q=H.filter(N=>N.includes("gpt"));r(W,Q.length>0?Q[0]:H[0],!0)}M(`Selected model set to: ${e(W)}`)}}else throw new Error("Invalid model data format")}catch(T){const B=T instanceof Error?T.message:"Failed to load models";r(F,B,!0),console.error("Error fetching models:",T),r(m,["gpt-3.5-turbo","gpt-4"],!0),(!e(W)||!e(m).includes(e(W)))&&r(W,e(m)[0],!0),M(`Using fallback models due to error. Selected: ${e(W)}`)}finally{r(fe,!1)}}async function ye(){if(!e(n).trim()||e(l)||!p()||!L())return;M(`Submitting message with model: ${e(W)}`),r(l,!0),r(K,!0);const T={id:Date.now().toString(),role:"user",content:e(n)};r(v,[...e(v),T],!0);const B={model:s()?`lamb_assistant.${s()}`:e(W),messages:e(v).map(({role:N,content:O})=>({role:N,content:O})),stream:!0};M(`Using model: ${B.model}`),r(n,"");const H=(Date.now()+1).toString();r(v,[...e(v),{id:H,role:"assistant",content:""}],!0);let Q="";try{M(`Sending request to ${p()}/chat/completions`);const N=await fetch(`${p()}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L()}`},body:JSON.stringify(B)});if(!N.ok){const ae=await N.text();throw new Error(`API Error: ${N.status} - ${ae}`)}if(!N.body)throw new Error("Response body is null");const O=N.body.getReader(),se=new TextDecoder;let ee="";for(M("Starting stream processing");;){const{done:ae,value:ue}=await O.read();if(ae){M("Stream finished.");break}ee+=se.decode(ue,{stream:!0});const Ne=ee.split(`
`);ee=Ne.pop()||"";for(const ge of Ne){if(ge.trim()===""||!ge.startsWith("data: "))continue;const xe=ge.substring(5).trim();if(xe==="[DONE]"){M("Received [DONE] signal");continue}try{const q=JSON.parse(xe);if(q.choices&&q.choices[0]&&q.choices[0].delta){const ie=q.choices[0].delta.content;ie&&(Q+=ie,r(v,e(v).map(Se=>Se.id===H?{...Se,content:Q}:Se),!0))}else M(`Received non-delta data chunk: ${xe.slice(0,100)}...`)}catch(q){M(`Error parsing JSON line: ${ge} - Error: ${q}`)}}if(ee.startsWith("data: ")){const ge=ee.substring(5).trim()}}r(v,e(v).map(ae=>ae.id===H?{...ae,content:Q}:ae),!0)}catch(N){M(`Error during chat submission: ${N.message}`),console.error("Chat error:",N),r(v,e(v).map(O=>O.id===H?{...O,content:`Error: ${N.message}`}:O),!0)}finally{r(l,!1),r(K,!1),M("Chat submission finished.")}}qr(()=>{M("ChatInterface mounted."),je()}),Oa(()=>{e(v)&&e(z)&&Promise.resolve().then(()=>{e(z)&&(e(z).scrollTop=e(z).scrollHeight,M("Scrolled chat container to bottom."))})});var Pe=Vo(),he=a(Pe),X=i(a(he),2);k(X,T=>{}),t(he);var ve=i(he,2),re=a(ve);ya(re,17,()=>e(v),T=>T.id,(T,B)=>{var H=zo(),Q=a(H),N=a(Q);{var O=ee=>{var ae=Go(),ue=a(ae,!0);t(ae),f(()=>o(ue,e(B).content||"Thinking...")),c(ee,ae)},se=ee=>{var ae=Ko(),ue=a(ae,!0);t(ae),f(()=>o(ue,e(B).content)),c(ee,ae)};k(N,ee=>{e(B).role==="assistant"&&e(K)&&e(B).id===e(v)[e(v).length-1].id?ee(O):ee(se,!1)})}t(Q),t(H),f(()=>{wa(H,1,`flex ${e(B).role==="user"?"justify-end":"justify-start"}`),wa(Q,1,`max-w-xs md:max-w-md lg:max-w-lg xl:max-w-xl px-4 py-2 rounded-lg shadow ${e(B).role==="user"?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"}`)}),c(T,H)});var Fe=i(re,2);{var Ce=T=>{var B=qo();c(T,B)};k(Fe,T=>{var B;e(l)&&!e(K)&&((B=e(v)[e(v).length-1])==null?void 0:B.role)==="user"&&T(Ce)})}t(ve),ds(ve,T=>r(z,T),()=>e(z));var we=i(ve,2),le=a(we),J=a(le);Ma(J);var be=i(J,2),_e=a(be);{var Le=T=>{var B=Jo();c(T,B)},Re=T=>{var B=ua("Send");c(T,B)};k(_e,T=>{e(l)?T(Le):T(Re,!1)})}t(be),t(le),t(we),t(Pe),f(T=>{J.disabled=e(l),be.disabled=T},[()=>e(l)||!e(n).trim()]),Fr("submit",le,T=>(T.preventDefault(),ye(),!1)),Ba(J,()=>e(n),T=>r(n,T)),c(I,Pe),lr()}var Wo=g('<div class="mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded text-sm" role="alert"> </div>'),Yo=xr('<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> ',1),Zo=g('<div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity z-40" aria-hidden="true"></div> <div class="fixed inset-0 z-50 flex items-center justify-center p-4"><div class="relative bg-white rounded-lg shadow-xl overflow-hidden max-w-lg w-full border border-gray-300" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="bg-gray-50 px-4 py-3 sm:px-6 border-b border-gray-200"><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title"> </h3></div> <div class="px-4 py-5 sm:p-6"><p class="text-sm text-gray-600 mb-4"> </p> <div><label for="new-assistant-name" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1"><input type="text" id="new-assistant-name" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md disabled:bg-gray-100"></div></div> <!></div> <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-gray-200"><button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-brand text-base font-medium text-white hover:bg-brand-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50" style="background-color: #2271b3;"><!></button> <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"> </button></div></div></div>',1);function Xo(I,d){nr(d,!0);const[p,L]=yr(),E=()=>ka(wr,"$_",p);let s=Ft(d,"isOpen",11,!1),v=Ft(d,"originalName",3,""),n=Ft(d,"defaultNewName",3,""),l=Ft(d,"isSubmitting",11,!1),m=Ft(d,"error",3,""),W=b(""),fe=b(!1);Oa(()=>{n()&&r(W,n())});let F=()=>{};Oa(()=>(F=hr.subscribe(X=>{r(fe,!!X)}),()=>{F()}));function K(){var X;!e(W).trim()||l()||(X=d.onSubmit)==null||X.call(d,{newName:e(W).trim()})}function z(){var X;(X=d.onClose)==null||X.call(d)}function M(X){const ve=X.target,re=ve.value.replace(/[^a-zA-Z0-9_-]/g,"");ve.value!==re&&(ve.value=re),r(W,re,!0)}function je(X){X.key==="Escape"&&z(),X.key==="Enter"&&K()}var ye=_r();Fr("keydown",ls,je);var Pe=He(ye);{var he=X=>{var ve=Zo(),re=He(ve);re.__click=z;var Fe=i(re,2),Ce=a(Fe),we=a(Ce),le=a(we),J=a(le,!0);t(le),t(we);var be=i(we,2),_e=a(be),Le=a(_e,!0);t(_e);var Re=i(_e,2),T=a(Re),B=a(T,!0);t(T);var H=i(T,2),Q=a(H);Ma(Q),Q.__input=M,t(H),t(Re);var N=i(Re,2);{var O=q=>{var ie=Wo(),Se=a(ie,!0);t(ie),f(()=>o(Se,m())),c(q,ie)};k(N,q=>{m()&&q(O)})}t(be);var se=i(be,2),ee=a(se);ee.__click=K;var ae=a(ee);{var ue=q=>{var ie=Yo(),Se=i(He(ie),1,!0);f(Wt=>o(Se,Wt),[()=>e(fe)?E()("assistants.duplicateModal.submitting",{default:"Creating..."}):"Creating..."]),c(q,ie)},Ne=q=>{var ie=ua();f(Se=>o(ie,Se),[()=>e(fe)?E()("assistants.duplicateModal.submitButton",{default:"Create Duplicate"}):"Create Duplicate"]),c(q,ie)};k(ae,q=>{l()?q(ue):q(Ne,!1)})}t(ee);var ge=i(ee,2);ge.__click=z;var xe=a(ge,!0);t(ge),t(se),t(Ce),t(Fe),f((q,ie,Se,Wt,Aa,Ea)=>{o(J,q),o(Le,ie),o(B,Se),Q.disabled=l(),Ot(Q,"placeholder",Wt),ee.disabled=Aa,ge.disabled=l(),o(xe,Ea)},[()=>e(fe)?E()("assistants.duplicateModal.title",{default:"Duplicate Assistant"}):"Duplicate Assistant",()=>e(fe)?E()("assistants.duplicateModal.description",{values:{name:v()},default:`Creating a copy of assistant: ${v()}`}):`Creating a copy of assistant: ${v()}`,()=>e(fe)?E()("assistants.duplicateModal.newNameLabel",{default:"New Assistant Name"}):"New Assistant Name",()=>e(fe)?E()("assistants.duplicateModal.newNamePlaceholder",{default:"Enter name for the copy..."}):"Enter name for the copy...",()=>l()||!e(W).trim(),()=>e(fe)?E()("common.cancel",{default:"Cancel"}):"Cancel"]),Ba(Q,()=>e(W),q=>r(W,q)),c(X,ve)};k(Pe,X=>{s()&&X(he)})}c(I,ye),lr(),L()}ir(["click","input"]);function Qo(I,d,p){var L;d()||(L=p.onConfirm)==null||L.call(p)}var ei=g('<p class="text-sm text-red-600 mt-2"> </p>'),ti=xr('<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),ai=g('<div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity z-40" aria-hidden="true"></div> <div class="fixed inset-0 z-50 flex items-center justify-center p-4"><div class="relative bg-white rounded-lg shadow-xl overflow-hidden max-w-lg w-full border border-gray-300" role="dialog" aria-modal="true" aria-labelledby="modal-title-delete"><div class="bg-red-50 px-4 py-3 sm:px-6 border-b border-red-200 flex items-center"><svg class="h-6 w-6 text-red-600 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg> <h3 class="text-lg leading-6 font-medium text-red-900" id="modal-title-delete"> </h3></div> <div class="px-4 py-5 sm:p-6"><p class="text-sm text-gray-700"> </p> <!></div> <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-gray-200"><button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"><!> </button> <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"> </button></div></div></div>',1);function ri(I,d){nr(d,!0);const[p,L]=yr(),E=()=>ka(wr,"$_",p);let s=Ft(d,"isOpen",11,!1),v=Ft(d,"assistantName",3,""),n=Ft(d,"isDeleting",11,!1),l=b(!1),m=()=>{};Oa(()=>(m=hr.subscribe(M=>{r(l,!!M)}),()=>{m()}));function W(){var M;n()||(M=d.onClose)==null||M.call(d)}function fe(M){M.key==="Escape"&&W()}var F=_r();Fr("keydown",ls,fe);var K=He(F);{var z=M=>{var je=ai(),ye=He(je);ye.__click=W;var Pe=i(ye,2),he=a(Pe),X=a(he),ve=i(a(X),2),re=a(ve,!0);t(ve),t(X);var Fe=i(X,2),Ce=a(Fe),we=a(Ce,!0);t(Ce);var le=i(Ce,2);{var J=Q=>{var N=ei(),O=a(N,!0);t(N),f(se=>o(O,se),[()=>e(l)?E()("assistants.deleteModal.deleting",{default:"Deleting..."}):"Deleting..."]),c(Q,N)};k(le,Q=>{n()&&Q(J)})}t(Fe);var be=i(Fe,2),_e=a(be);_e.__click=[Qo,n,d];var Le=a(_e);{var Re=Q=>{var N=ti();c(Q,N)};k(Le,Q=>{n()&&Q(Re)})}var T=i(Le);t(_e);var B=i(_e,2);B.__click=W;var H=a(B,!0);t(B),t(be),t(he),t(Pe),f((Q,N,O,se)=>{o(re,Q),o(we,N),_e.disabled=n(),o(T,` ${O??""}`),B.disabled=n(),o(H,se)},[()=>e(l)?E()("assistants.deleteModal.title",{default:"Delete Assistant"}):"Delete Assistant",()=>e(l)?E()("assistants.deleteModal.confirmation",{values:{name:v()},default:`Are you sure you want to delete the assistant "${v()}"? This action cannot be undone.`}):`Are you sure you want to delete the assistant "${v()}"? This action cannot be undone.`,()=>e(l)?E()("assistants.deleteModal.confirmButton",{default:"Delete"}):"Delete",()=>e(l)?E()("common.cancel",{default:"Cancel"}):"Cancel"]),c(M,je)};k(K,M=>{s()&&M(z)})}c(I,F),lr(),L()}ir(["click"]);var si=g('<div class="relative"><button class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm rounded-t-md bg-brand text-white border-brand cursor-default" style="background-color: #2271b3; color: white; border-color: #2271b3;" disabled> <!></button></div>'),oi=g('<div class="mt-6"><div class="bg-white shadow rounded-lg p-4 border border-gray-200"><!></div></div>'),ii=(I,d)=>r(d,"properties"),ni=(I,d)=>r(d,"edit"),li=(I,d)=>r(d,"chat"),di=g("<p> </p>"),ci=g('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold"> </strong> <span class="block sm:inline"> </span> <button class="ml-4 underline"> </button></div>'),ui=(I,d)=>r(d,"edit"),pi=(I,d,p)=>d({detail:{id:e(p).id,name:e(p).name}}),fi=(I,d,p)=>d({detail:{id:e(p).id}}),vi=xr('<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> ',1),gi=xr('<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> ',1),mi=(I,d,p)=>d({detail:{id:e(p).id,name:e(p).name,published:e(p).published}}),bi=g('<div class="p-4 border border-blue-200 rounded bg-blue-50"><h3 class="text-lg font-semibold text-blue-800 mb-2"> </h3> <div class="space-y-1 text-sm text-blue-700 break-words"><div><span class="font-medium"> </span> <code class="ml-1 bg-blue-100 px-1 rounded"> </code></div> <div><span class="font-medium"> </span> <code class="ml-1 bg-blue-100 px-1 rounded"> </code></div> <div><span class="font-medium"> </span> <code class="ml-1 bg-blue-100 px-1 rounded">ASK ADMIN FOR THE SECRET</code></div></div></div>'),_i=g('<div><div class="font-medium text-gray-700 mb-1"> </div> <div class="bg-white border border-gray-200 p-2 rounded w-24 text-center"> </div></div>'),hi=g('<div class="bg-white border border-gray-200 p-2 rounded text-gray-500 italic"> </div>'),xi=g('<div class="bg-red-50 border border-red-200 p-2 rounded text-red-600 italic"> </div>'),yi=g('<span class="inline-block bg-gray-200 rounded px-2 py-0.5 text-xs font-medium text-gray-700"> </span>'),wi=g('<div class="bg-white border border-gray-200 p-2 rounded space-y-1"></div>'),ki=g('<div class="bg-white border border-gray-200 p-2 rounded text-gray-500 italic"> </div>'),Ai=g('<div><div class="font-medium text-gray-700 mb-1"> </div> <!></div>'),Ei=g('<div><div class="font-medium text-gray-700 mb-1"> </div> <div class="bg-white border border-gray-200 p-2 rounded break-all"> </div></div>'),Ci=g('<div class="pt-3 mt-3 border-t border-gray-300 space-y-3"><h4 class="text-md font-medium text-gray-700"> </h4> <!> <!> <!></div>'),$i=g('<div class="space-y-3 text-sm"><div><div class="font-medium text-gray-700 mb-1"> </div> <div class="bg-white border border-gray-200 p-2 rounded"> </div></div> <div><div class="font-medium text-gray-700 mb-1"> </div> <div class="bg-white border border-gray-200 p-2 rounded"> </div></div> <div><div class="font-medium text-gray-700 mb-1"> </div> <div class="bg-white border border-gray-200 p-2 rounded"> </div></div> <div><div class="font-medium text-gray-700 mb-1"> </div> <div class="bg-white border border-gray-200 p-2 rounded"> </div></div> <!></div>'),Si=g('<div class="md:w-1/3 mt-6 md:mt-0 space-y-4"><!> <div class="p-4 border border-gray-200 rounded bg-gray-50"><h3 class="text-lg font-semibold text-gray-800 mb-2"> </h3> <!></div></div>'),Ii=g('<div class="flex justify-between items-center px-6 py-4 border-b border-gray-200"><h2 class="text-xl font-semibold text-gray-800"> </h2> <div class="flex space-x-2"><button type="button" class="px-3 py-1 text-sm font-medium rounded text-indigo-600 bg-white border border-indigo-600 hover:bg-indigo-100 transition-colors"> </button> <button type="button" class="px-3 py-1 text-sm font-medium rounded text-white hover:bg-opacity-90 transition-colors" style="background-color: #2271b3;"> </button> <button type="button" class="px-3 py-1 text-sm font-medium rounded bg-green-600 text-white hover:bg-green-700 transition-colors"><!></button> <button type="button"><!></button> <button type="button" class="px-3 py-1 text-sm font-medium rounded bg-red-600 text-white hover:bg-red-700 transition-colors"> </button></div></div> <div class="flex flex-col md:flex-row md:space-x-6 px-6 py-4"><div class="flex-grow md:w-2/3 space-y-4"><div><div class="block text-sm font-medium text-gray-700"> <span class="text-red-600">*</span></div> <div class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed sm:text-sm"> </div></div> <div><div class="block text-sm font-medium text-gray-700"> </div> <div class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed sm:text-sm min-h-[6em] whitespace-pre-wrap"> </div></div> <div><div class="block text-sm font-medium text-gray-700"> </div> <div class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed sm:text-sm min-h-[8em] whitespace-pre-wrap"> </div></div> <div><div class="block text-sm font-medium text-gray-700"> </div> <div class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed sm:text-sm min-h-[8em] whitespace-pre-wrap"> </div></div></div> <!></div>',1),Ni=g('<div class="px-6 py-4"><div class="mb-6 pb-4 border-b border-gray-200"><h2 class="text-xl font-semibold text-gray-800"> </h2></div> <div class="w-full"><!></div></div>'),Di=g('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold"> </strong> <span class="block sm:inline"> </span></div>'),Ti=g('<div class="px-6 py-4 border-b border-gray-200"><h2 class="text-xl font-semibold text-gray-800"> </h2></div> <!>',1),Pi=g("<p> </p>"),Fi=g('<div class="mb-4 border-b border-gray-300 flex space-x-4"><button> </button> <button> </button> <button> <!></button></div> <div class="bg-white shadow rounded-lg border border-gray-200"><!></div>',1),Li=g("<p> </p>"),Ri=g("<p> </p>"),Mi=g('<h1 class="text-3xl font-bold mb-4 text-brand"> </h1> <div class="mb-6 border-b border-gray-200"><nav class="-mb-px flex space-x-8" aria-label="Tabs"><button> </button> <button> </button> <!></nav></div> <!> <!> <!> <!>',1);function an(I,d){nr(d,!0);const[p,L]=yr(),E=()=>ka(Yr,"$page",p),s=()=>ka(wr,"$_",p),v=()=>ka(hr,"$locale",p);let n=b("list"),l=b(null),m=b(null),W=b(null),fe=b(!1),F=b(""),K=b(!1),z=b(It(E().url.searchParams.get("startInEdit")==="true"?"edit":"properties")),M=b(""),je=b(""),ye=b(""),Pe=null,he=b(!1),X=b(null),ve=b(null),re=b(null),Fe=b(!1),Ce=b(!1),we=b(""),le=b(""),J=b(!1),be=b(null),_e=b(null),Le=b(!1),Re=b(""),T=b(!1),B=b(null),H=b(!1),Q=b(""),N=b(It([])),O=b(!1),se=b(""),ee=b(!1);function ae(){console.log("Navigating to create form"),r(m,null),r(n,"create"),r(K,!1),sr(`${rr}/assistants?view=create`,{replaceState:!0})}function ue(){console.log("Navigating back to list view (assistants base path)"),r(n,"list"),r(K,!1),sr(`${rr}/assistants`,{replaceState:!0})}async function Ne(_){if(e(W)!==_){r(W,_,!0),r(fe,!0),r(F,""),r(m,null),r(n,"detail");try{console.log(`Fetching assistant ID: ${_}.`);const y=await Xr(_);if(y){let S={};const R=y.metadata||y.api_callback;if(R)try{S=JSON.parse(R)}catch(De){console.error("Error parsing metadata JSON:",De)}const P={...y,...S,id:y.id.toString()};r(m,P,!0),console.log("Assigned selectedAssistantData:",e(m)),sr(`${rr}/assistants?view=detail&id=${_}`,{replaceState:!0,noScroll:!0})}else r(F,s()("assistant_not_found",{values:{id:_}}),!0),console.error(e(F)),ue()}catch(y){console.error("Error fetching assistant details:",y),r(F,y instanceof Error?y.message:s()("error_fetching_assistant"),!0),ue()}finally{r(fe,!1)}}}qr(()=>{console.log("Assistants page mounted");try{const _=zr();if(console.log("[DEBUG] Assistants page onMount: Config object received:",JSON.stringify(_,null,2)),_&&_.api&&_.api.lambServer&&_.api.lambApiKey)r(M,_.api.lambServer.replace(/\/$/,""),!0),r(je,_.api.lambApiKey,!0),console.log("LAMB config loaded for chat - API URL:",e(M)),console.log("LAMB config loaded for chat - Has API Key:",!!e(je));else throw new Error("Missing required LAMB configuration (lambServer or lambApiKey).")}catch(_){r(ye,_ instanceof Error?_.message:"Failed to load LAMB configuration.",!0),console.error(e(ye))}r(l,v()??null,!0),Pe=Yr.subscribe(_=>{var De;console.log("Page store updated:",_.url.searchParams.toString());const y=_.url.searchParams.get("view"),S=_.url.searchParams.get("id"),R=_.url.searchParams.get("startInEdit");console.log(`[+page.svelte] URL Params: view=${y}, id=${S}, startInEdit=${R}`);const P=R==="true";if(console.log(`[+page.svelte] requestedStartEdit evaluated to: ${P}`),y==="create")e(n)!=="create"&&(console.log("URL indicates 'create' view."),ae());else if(y==="detail"&&S){const me=parseInt(S,10);isNaN(me)?(console.warn("Invalid assistant ID in URL parameter."),ue()):(r(K,P),console.log(`[+page.svelte] Set startEditMode state to: ${e(K)}`),e(n)!=="detail"&&(r(n,"detail"),r(z,"properties")),((De=e(m))==null?void 0:De.id)!==me.toString()?(console.log(`[+page.svelte] Fetching detail for new ID: ${me}`),Ne(me)):(console.log(`[+page.svelte] ID ${me} already loaded. Skipping fetch.`),r(fe,!1)))}else e(n)!=="list"&&(console.log("URL indicates 'list' view."),ue())})}),gs(()=>{console.log("Assistants page unmounting"),Pe&&Pe()}),Oa(()=>{(v()??null)!==e(l)&&(console.log(`Locale changed from ${e(l)} to ${v()}`),r(l,v()??null,!0))});function ge(_){if(_.detail&&typeof _.detail.assistantId=="number"){const y=_.detail.assistantId;console.log(`Assistant created with ID: ${y}, navigating to list view.`),sr(`${rr}/assistants`,{replaceState:!0})}else console.error("handleAssistantCreated received event without expected detail:",_),r(F,"Failed to navigate to new assistant. Event detail missing."),ue()}async function xe(_){const{id:y,name:S}=_.detail;console.log(`Duplicate request received for ID: ${y}, Name: ${S}`),r(X,y,!0),r(ve,S,!0),r(re,null),r(Fe,!0),r(he,!1),r(le,"");try{const R=await Xr(y);if(R){r(re,R,!0);const P=S.includes("_")?S.substring(S.indexOf("_")+1):S;r(we,`Copy_${P}`),r(he,!0)}else throw new Error(`Assistant with ID ${y} not found.`)}catch(R){console.error("Error fetching assistant details for duplication:",R),r(le,R instanceof Error?R.message:s()("error_fetching_assistant"),!0),alert(`Error preparing duplication: ${e(le)}`)}finally{r(Fe,!1)}}async function q(_){const y=_.detail.newName;if(!e(re)||!y){r(le,"Missing data for duplication.");return}r(Ce,!0),r(le,"");try{const S=e(re),R={name:y,description:S.description||"",system_prompt:S.system_prompt||S.instructions||"",prompt_template:S.prompt_template||"",metadata:S.metadata||S.api_callback||"",pre_retrieval_endpoint:S.pre_retrieval_endpoint||"",post_retrieval_endpoint:S.post_retrieval_endpoint||"",RAG_endpoint:S.RAG_endpoint||"",RAG_Top_k:S.RAG_Top_k??3,RAG_collections:S.RAG_collections||""};console.log("Creating duplicate assistant with data:",R);const P=await us(R);if(P&&P.assistant_id)console.log("Duplicate created successfully, ID:",P.assistant_id),r(he,!1),r(X,null),r(re,null),r(ve,null),r(we,""),sr(`${rr}/assistants?view=detail&id=${P.assistant_id}`,{replaceState:!0});else throw new Error("Create operation did not return a valid assistant ID.")}catch(S){console.error("Error creating duplicate assistant:",S),r(le,S instanceof Error?S.message:s()("assistants.duplicateModal.submitError",{default:"Failed to create duplicate."}),!0)}finally{r(Ce,!1)}}function ie({detail:_}){const{id:y,name:S,published:R}=_;if(console.log(`Delete request received for ID: ${y}, Name: ${S}, Published: ${R}`),R){alert(e(l)?s()("assistants.deleteErrorPublished"):"Cannot delete a published assistant. Please unpublish it first.");return}r(be,y,!0),r(_e,S,!0),r(Re,""),r(J,!0)}async function Se(){var _;if(e(be)){r(Le,!0),r(Re,"");try{console.log(`Attempting to delete assistant ID: ${e(be)}`),await ys(e(be)),console.log(`Assistant ${e(be)} deleted successfully.`),r(J,!1);const y=e(be);r(be,null),r(_e,null),e(n)==="detail"&&((_=e(m))==null||_.id,y.toString()),ue()}catch(y){console.error(`Error deleting assistant ${e(be)}:`,y),r(Re,y instanceof Error?y.message:s()("assistants.deleteModal.deleteError",{default:"Failed to delete assistant."}),!0)}finally{r(Le,!1)}}}function Wt(_){if(!_)return"assistant_export.json";const y=_.match(/filename=["']?([^"';]+)["']?/);return(y==null?void 0:y[1])||"assistant_export.json"}async function Aa({detail:_}){var R;const{id:y}=_;if(console.log(`Export request received for ID: ${y}`),e(T))return;r(B,y,!0),r(T,!0);let S=null;try{if(Zr&&(S=localStorage.getItem("userToken")),!S)throw new Error("Authentication token not found.");let P="";try{const w=zr();if(P=(R=w==null?void 0:w.api)==null?void 0:R.lambServer,!P)throw new Error}catch{throw console.error("Failed to get server URL from config for export"),new Error("Configuration error, cannot determine export URL.")}const De=`${P.replace(/\/$/,"")}/creator/assistant/export/${y}`;console.log(`Fetching export from: ${De}`);const me=await fetch(De,{headers:{Authorization:`Bearer ${S}`}});if(!me.ok){let w=`Failed to export assistant ${y}`;try{const D=await me.json();w=(D==null?void 0:D.detail)||`${w} (Status: ${me.status})`}catch{w=`${w} (Status: ${me.status})`}throw new Error(w)}const gt=me.headers.get("Content-Disposition"),ze=Wt(gt),u=await me.blob(),A=URL.createObjectURL(u),$=document.createElement("a");$.href=A,$.download=ze,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(A),console.log(`Successfully triggered download for ${ze}`)}catch(P){console.error("Error during assistant export:",P),alert(`Export failed: ${P instanceof Error?P.message:"Unknown error"}`)}finally{r(T,!1),r(B,null)}}async function Ea(){if(!e(m)||!e(m).id)return;const _=parseInt(e(m).id,10),S=!e(m).published;r(H,!0),r(Q,"");let R=null;try{if(Zr&&(R=localStorage.getItem("userToken")),!R)throw new Error("Authentication token not found.");console.log(`Attempting to set publish status for ${_} to ${S}`);const P=await ks(_,S);r(m,P,!0),console.log("Publish status updated successfully.")}catch(P){console.error("Error toggling publish status:",P),r(Q,P instanceof Error?P.message:"Failed to update publish status.",!0),alert(`Error: ${e(Q)}`)}finally{r(H,!1)}}async function Ya(){var S,R;if(e(O)||e(ee))return;let _="";const y=((S=e(m))==null?void 0:S.metadata)||((R=e(m))==null?void 0:R.api_callback);if(y)try{_=JSON.parse(y).rag_processor}catch(P){console.error("Error parsing metadata for KB fetch check:",P)}if(_!=="simple_rag"){console.log("Skipping KB fetch for detail view (not simple_rag)"),r(N,[],!0),r(se,""),r(ee,!0);return}console.log("Fetching knowledge bases for detail view..."),r(O,!0),r(se,""),r(N,[],!0);try{const P=await cs();P.sort((De,me)=>De.name.localeCompare(me.name)),r(N,P,!0),console.log("Fetched KBs for detail view:",e(N))}catch(P){console.error("Error fetching knowledge bases for detail view:",P),r(se,P instanceof Error?P.message:"Failed to load knowledge bases",!0)}finally{r(O,!1),r(ee,!0)}}Oa(()=>{var S,R,P;const _=(R=(S=e(m))==null?void 0:S.id)==null?void 0:R.toString(),y=(P=e(W))==null?void 0:P.toString();e(n)==="detail"&&_&&_===y&&!e(ee)&&(console.log(`$effect triggering KB fetch for detail view (ID: ${_})`),Ya()),(e(n)!=="detail"||_&&y&&_!==y)&&e(ee)&&(console.log(`$effect resetting KB fetch trigger. CurrentView: ${e(n)}, assistantIdStr: ${_}, lastAttemptedIdStr: ${y}`),r(ee,!1),r(N,[],!0),r(se,""))});var jt=Mi(),Na=He(jt),pa=a(Na,!0);t(Na);var fa=i(Na,2),va=a(fa),ga=a(va);ga.__click=ue;var ja=a(ga,!0);t(ga);var ot=i(ga,2);ot.__click=ae;var $e=a(ot,!0);t(ot);var bt=i(ot,2);{var Yt=_=>{var y=si(),S=a(y),R=a(S),P=i(R);{var De=me=>{var gt=ua();f(ze=>o(gt,`(${ze??""})`),[()=>{var ze;return((ze=e(m).name)==null?void 0:ze.replace(/^\d+_/,""))||"..."}]),c(me,gt)};k(P,me=>{e(m)&&me(De)})}t(S),t(y),f(me=>o(R,`${me??""} `),[()=>e(l)?s()("assistants.detailViewTab"):"Assistant Detail"]),c(_,y)};k(bt,_=>{e(n)==="detail"&&(e(m)||e(fe))&&_(Yt)})}t(va),t(fa);var Zt=i(fa,2);{var ma=_=>{var y=oi(),S=a(y),R=a(S);Vs(R,{$$events:{duplicate:xe,delete:ie,export:Aa}}),t(S),t(y),c(_,y)},Xt=(_,y)=>{{var S=P=>{os(P,{assistant:null,$$events:{formSuccess:ge}})},R=(P,De)=>{{var me=ze=>{var u=Fi(),A=He(u),$=a(A);$.__click=[ii,z];var w=a($,!0);t($);var D=i($,2);D.__click=[ni,z];var Y=a(D,!0);t(D);var Z=i(D,2);Z.__click=[li,z];var Ae=a(Z),j=i(Ae);{var U=Me=>{var We=ua();f((oe,te)=>o(We,`${oe??""} ${te??""}`),[()=>e(l)?s()("assistants.detail.chatWith",{default:"with"}):"with",()=>e(m).name.replace(/^\d+_/,"")]),c(Me,We)};k(j,Me=>{e(m)&&e(m).name&&Me(U)})}t(Z),t(A);var G=i(A,2),V=a(G);{var Ie=Me=>{var We=di(),oe=a(We,!0);t(We),f(te=>o(oe,te),[()=>e(l)?s()("assistants.loadingDetail"):"Loading assistant details..."]),c(Me,We)},Nt=(Me,We)=>{{var oe=_t=>{var Ge=ci(),qe=a(Ge),Lt=a(qe,!0);t(qe);var Je=i(qe,2),Ye=a(Je,!0);t(Je);var ht=i(Je,2);ht.__click=ue;var Ga=a(ht,!0);t(ht),t(Ge),f((xt,_a)=>{o(Lt,xt),o(Ye,e(F)),o(Ga,_a)},[()=>e(l)?s()("assistants.errorTitle"):"Error:",()=>e(l)?s()("common.backToList"):"Back to list"]),c(_t,Ge)},te=(_t,Ge)=>{{var qe=Lt=>{var Je=_r(),Ye=He(Je);{var ht=xt=>{var _a=Ii(),Gt=He(_a),ra=a(Gt),Kt=a(ra,!0);t(ra);var yt=i(ra,2),Ze=a(yt);Ze.__click=[ui,z];var it=a(Ze,!0);t(Ze);var dt=i(Ze,2);dt.__click=[pi,xe,m];var wt=a(dt,!0);t(dt);var Xe=i(dt,2);Xe.__click=[fi,Aa,m];var Rt=a(Xe);{var Dt=Te=>{var et=vi(),kt=i(He(et),1,!0);f(zt=>o(kt,zt),[()=>e(l)?s()("common.exporting",{default:"Exporting..."}):"Exporting..."]),c(Te,et)},Qe=Te=>{var et=ua();f(kt=>o(et,kt),[()=>e(l)?s()("common.export",{default:"Export"}):"Export"]),c(Te,et)};k(Rt,Te=>{e(T)&&e(B)===e(m).id?Te(Dt):Te(Qe,!1)})}t(Xe);var ct=i(Xe,2);ct.__click=Ea;var ha=a(ct);{var ut=Te=>{var et=gi(),kt=i(He(et),1,!0);f(zt=>o(kt,zt),[()=>e(l)?s()("common.updating",{default:"Updating..."}):"Updating..."]),c(Te,et)},Tt=(Te,et)=>{{var kt=Bt=>{var lt=ua();f(Ca=>o(lt,Ca),[()=>e(l)?s()("common.unpublish",{default:"Unpublish"}):"Unpublish"]),c(Bt,lt)},zt=Bt=>{var lt=ua();f(Ca=>o(lt,Ca),[()=>e(l)?s()("common.publish",{default:"Publish"}):"Publish"]),c(Bt,lt)};k(Te,Bt=>{var lt;(lt=e(m))!=null&&lt.published?Bt(kt):Bt(zt,!1)},et)}};k(ha,Te=>{e(H)?Te(ut):Te(Tt,!1)})}t(ct);var nt=i(ct,2);nt.__click=[mi,ie,m];var Mt=a(nt,!0);t(nt),t(yt),t(Gt);var Ta=i(Gt,2),xa=a(Ta),sa=a(xa),Ka=a(sa),kr=a(Ka);or(),t(Ka);var Ar=i(Ka,2),Er=a(Ar,!0);t(Ar),t(sa);var dr=i(sa,2),za=a(dr),cr=a(za,!0);t(za);var Cr=i(za,2),Za=a(Cr,!0);t(Cr),t(dr);var ur=i(dr,2),pr=a(ur),Lr=a(pr,!0);t(pr);var Xa=i(pr,2),fr=a(Xa,!0);t(Xa),t(ur);var $r=i(ur,2),Pa=a($r),Rr=a(Pa,!0);t(Pa);var Sr=i(Pa,2),Ir=a(Sr,!0);t(Sr),t($r),t(xa);var Mr=i(xa,2);{var Nr=Te=>{var et=Si(),kt=a(et);{var zt=h=>{var x=bi(),C=a(x),ne=a(C,!0);t(C);var de=i(C),ce=i(de),ke=a(ce),Be=a(ke),At=a(Be);t(Be);var Pt=i(Be,2),tt=a(Pt);t(Pt),t(ke);var Ve=i(ke,2),at=a(Ve),oa=a(at);t(at);var pt=i(at,2),qt=a(pt,!0);t(pt),t(Ve);var ia=i(Ve,2),Ke=a(ia),ft=a(Ke);t(Ke),or(2),t(ia),t(ce),t(x),f((na,$a,Ut,la,Sa,Ia)=>{o(ne,na),o(de,` ${$a??""} `),o(At,`${Ut??""}:`),o(tt,`${e(M)??""}/lamb/v1/lti_users/lti`),o(oa,`${la??""}:`),o(qt,Sa),o(ft,`${Ia??""}:`)},[()=>e(l)?s()("assistants.detail.ltiTitle",{default:"LTI Publish Details"}):"LTI Publish Details",()=>console.log("Checking selectedAssistantData for LTI box:",e(m)),()=>e(l)?s()("assistants.detail.ltiToolUrl",{default:"Tool URL"}):"Tool URL",()=>e(l)?s()("assistants.detail.ltiConsumerKey",{default:"Consumer Key"}):"Consumer Key",()=>e(m).oauth_consumer_name||(e(l)?s()("common.notAvailable",{default:"N/A"}):"N/A"),()=>e(l)?s()("assistants.detail.ltiSecret",{default:"Secret"}):"Secret"]),c(h,x)};k(kt,h=>{e(m).published&&h(zt)})}var Bt=i(kt,2),lt=a(Bt),Ca=a(lt,!0);t(lt);var vr=i(lt,2);{var gr=h=>{var x=$i();const C=Ua(()=>(()=>{try{const Ue=e(m).metadata||e(m).api_callback;return typeof Ue=="string"?JSON.parse(Ue):Ue||{}}catch(Ue){return console.error("Error parsing metadata:",Ue),{}}})());var ne=a(x),de=a(ne),ce=a(de,!0);t(de);var ke=i(de,2),Be=a(ke,!0);t(ke),t(ne);var At=i(ne,2),Pt=a(At),tt=a(Pt,!0);t(Pt);var Ve=i(Pt,2),at=a(Ve,!0);t(Ve),t(At);var oa=i(At,2),pt=a(oa),qt=a(pt,!0);t(pt);var ia=i(pt,2),Ke=a(ia,!0);t(ia),t(oa);var ft=i(oa,2),na=a(ft),$a=a(na,!0);t(na);var Ut=i(na,2),la=a(Ut,!0);t(Ut),t(ft);var Sa=i(ft,2);{var Ia=Ue=>{var pe=Ci(),Ee=a(pe),Et=a(Ee,!0);t(Ee);var Jt=i(Ee,2);{var mt=Oe=>{var rt=_i(),vt=a(rt),qa=a(vt,!0);t(vt);var $t=i(vt,2),St=a($t,!0);t($t),t(rt),f(Ht=>{o(qa,Ht),o(St,e(m).RAG_Top_k??3)},[()=>s()("assistants.form.ragTopK.label",{default:"RAG Top K"})]),c(Oe,rt)};k(Jt,Oe=>{e(C).rag_processor!=="single_file_rag"&&Oe(mt)})}var Ct=i(Jt,2);{var da=Oe=>{var rt=Ai(),vt=a(rt),qa=a(vt,!0);t(vt);var $t=i(vt,2);{var St=st=>{var Fa=hi(),Qa=a(Fa,!0);t(Fa),f(mr=>o(Qa,mr),[()=>s()("assistants.form.knowledgeBases.loading",{default:"Loading..."})]),c(st,Fa)},Ht=(st,Fa)=>{{var Qa=La=>{var br=xi(),Br=a(br,!0);t(br),f(Ur=>o(Br,Ur),[()=>s()("assistants.form.knowledgeBases.error",{default:"Error loading KBs"})]),c(La,br)},mr=(La,br)=>{{var Br=er=>{var Ja=wi();ya(Ja,21,()=>e(m).RAG_collections.split(","),ar,(Or,Dr)=>{var jr=yi();const Jr=Ua(()=>e(N).find(fs=>fs.id===e(Dr)));var ps=a(jr,!0);t(jr),f(()=>o(ps,e(Jr)?e(Jr).name:`${e(Dr)} (Not Found)`)),c(Or,jr)}),t(Ja),c(er,Ja)},Ur=er=>{var Ja=ki(),Or=a(Ja,!0);t(Ja),f(Dr=>o(Or,Dr),[()=>s()("common.none",{default:"None"})]),c(er,Ja)};k(La,er=>{e(m).RAG_collections?er(Br):er(Ur,!1)},br)}};k(st,La=>{e(se)?La(Qa):La(mr,!1)},Fa)}};k($t,st=>{e(O)?st(St):st(Ht,!1)})}t(rt),f(st=>o(qa,st),[()=>s()("assistants.form.knowledgeBases.label",{default:"Knowledge Bases"})]),c(Oe,rt)};k(Ct,Oe=>{e(C).rag_processor==="simple_rag"&&Oe(da)})}var Vt=i(Ct,2);{var ca=Oe=>{var rt=Ei(),vt=a(rt),qa=a(vt,!0);t(vt);var $t=i(vt,2),St=a($t,!0);t($t),t(rt),f((Ht,st)=>{o(qa,Ht),o(St,st)},[()=>s()("assistants.form.singleFile.selectedLabel",{default:"Selected File"}),()=>e(C).file_path||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified")]),c(Oe,rt)};k(Vt,Oe=>{e(C).rag_processor==="single_file_rag"&&Oe(ca)})}t(pe),f(Oe=>o(Et,Oe),[()=>s()("assistants.form.ragOptions.title",{default:"RAG Options"})]),c(Ue,pe)};k(Sa,Ue=>{e(C).rag_processor&&e(C).rag_processor!=="no_rag"&&Ue(Ia)})}t(x),f((Ue,pe,Ee,Et,Jt,mt,Ct,da)=>{o(ce,Ue),o(Be,pe),o(tt,Ee),o(at,Et),o(qt,Jt),o(Ke,mt),o($a,Ct),o(la,da)},[()=>e(l)?s()("assistants.form.promptProcessor.label",{default:"Prompt Processor"}):"Prompt Processor",()=>e(C).prompt_processor||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified"),()=>e(l)?s()("assistants.form.connector.label",{default:"Connector"}):"Connector",()=>e(C).connector||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified"),()=>e(l)?s()("assistants.form.llm.label",{default:"Language Model (LLM)"}):"Language Model (LLM)",()=>e(C).llm||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified"),()=>e(l)?s()("assistants.form.ragProcessor.label",{default:"RAG Processor"}):"RAG Processor",()=>{var Ue;return((Ue=e(C).rag_processor)==null?void 0:Ue.replace(/_/g," ").replace(/\b\w/g,pe=>pe.toUpperCase()))||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified")}]),c(h,x)};k(vr,h=>{e(m)&&h(gr)})}t(Bt),t(et),f(h=>o(Ca,h),[()=>e(l)?s()("assistants.detail.configuration",{default:"Configuration"}):"Configuration"]),c(Te,et)};k(Mr,Te=>{e(m)&&Te(Nr)})}t(Ta),f((Te,et,kt,zt,Bt,lt,Ca,vr,gr,h,x,C)=>{var ne;o(Kt,Te),o(it,et),dt.disabled=e(Fe),o(wt,kt),Xe.disabled=e(T)&&e(B)===e(m).id,wa(ct,1,`px-3 py-1 text-sm font-medium rounded text-white transition-colors ${(ne=e(m))!=null&&ne.published?"bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed":"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}`),ct.disabled=e(H),o(Mt,zt),o(kr,`${Bt??""} `),o(Er,lt),o(cr,Ca),o(Za,vr),o(Lr,gr),o(fr,h),o(Rr,x),o(Ir,C)},[()=>e(l)?s()("assistants.detail.propertiesTitle",{default:"Assistant Properties"}):"Assistant Properties",()=>e(l)?s()("common.edit",{default:"Edit"}):"Edit",()=>e(l)?s()("common.duplicate"):"Duplicate",()=>e(l)?s()("common.delete"):"Delete",()=>s()("assistants.form.name.label"),()=>{var Te;return((Te=e(m).name)==null?void 0:Te.replace(/^\d+_/,""))||(e(l)?s()("common.notAvailable",{default:"N/A"}):"N/A")},()=>s()("assistants.form.description.label",{default:"Description"}),()=>e(m).description||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified"),()=>s()("assistants.form.systemPrompt.label",{default:"System Prompt"}),()=>e(m).system_prompt||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified"),()=>s()("assistants.form.promptTemplate.label",{default:"Prompt Template"}),()=>e(m).prompt_template||(e(l)?s()("common.notSpecified",{default:"Not specified"}):"Not specified")]),c(xt,_a)},Ga=(xt,_a)=>{{var Gt=Kt=>{var yt=Ni(),Ze=a(yt),it=a(Ze),dt=a(it,!0);t(it),t(Ze);var wt=i(Ze,2),Xe=a(wt);os(Xe,{get assistant(){return e(m)},id:"assistant-edit-form",$$events:{formSuccess:()=>{Ne(e(m).id),r(z,"properties")}}}),t(wt),t(yt),f(Rt=>o(dt,Rt),[()=>e(l)?s()("assistants.detail.editTitle",{default:"Edit Assistant"}):"Edit Assistant"]),c(Kt,yt)},ra=(Kt,yt)=>{{var Ze=it=>{var dt=_r(),wt=He(dt);{var Xe=Dt=>{var Qe=Di(),ct=a(Qe),ha=a(ct,!0);t(ct);var ut=i(ct,2),Tt=a(ut);t(ut),t(Qe),f((nt,Mt)=>{o(ha,nt),o(Tt,`${e(ye)??""} - ${Mt??""}`)},[()=>e(l)?s()("assistants.detail.configErrorTitle",{default:"Configuration Error:"}):"Configuration Error:",()=>e(l)?s()("assistants.chatDisabled"):"Chat functionality is disabled."]),c(Dt,Qe)},Rt=(Dt,Qe)=>{{var ct=ut=>{var Tt=Ti(),nt=He(Tt),Mt=a(nt),Ta=a(Mt,!0);t(Mt),t(nt);var xa=i(nt,2);Ho(xa,{get apiUrl(){return e(M)},get apiKey(){return e(je)},get assistantId(){return e(m).id},get initialModel(){return e(m).llm}}),f(sa=>o(Ta,sa),[()=>e(l)?s()("assistants.detail.chatTitle",{default:"Chat"}):"Chat"]),c(ut,Tt)},ha=ut=>{var Tt=Pi(),nt=a(Tt,!0);t(Tt),f(Mt=>o(nt,Mt),[()=>e(l)?s()("assistants.chatLoadingConfig"):"Loading chat configuration..."]),c(ut,Tt)};k(Dt,ut=>{e(M)&&e(je)?ut(ct):ut(ha,!1)},Qe)}};k(wt,Dt=>{e(ye)?Dt(Xe):Dt(Rt,!1)})}c(it,dt)};k(Kt,it=>{e(z)==="chat"&&it(Ze)},yt)}};k(xt,Kt=>{e(z)==="edit"?Kt(Gt):Kt(ra,!1)},_a)}};k(Ye,xt=>{e(z)==="properties"?xt(ht):xt(Ga,!1)})}c(Lt,Je)};k(_t,Lt=>{e(m)&&Lt(qe)},Ge)}};k(Me,_t=>{e(F)?_t(oe):_t(te,!1)},We)}};k(V,Me=>{e(fe)?Me(Ie):Me(Nt,!1)})}t(G),f((Me,We,oe)=>{wa($,1,`py-2 px-4 text-sm font-medium rounded-t-md ${e(z)==="properties"?"bg-gray-100 border border-b-0 border-gray-300 text-brand":"text-gray-600 hover:text-gray-800"}`),o(w,Me),wa(D,1,`py-2 px-4 text-sm font-medium rounded-t-md ${e(z)==="edit"?"bg-gray-100 border border-b-0 border-gray-300 text-brand":"text-gray-600 hover:text-gray-800"}`),o(Y,We),wa(Z,1,`py-2 px-4 text-sm font-medium rounded-t-md ${e(z)==="chat"?"bg-gray-100 border border-b-0 border-gray-300 text-brand":"text-gray-600 hover:text-gray-800"}`),o(Ae,`${oe??""} `)},[()=>e(l)?s()("assistants.detail.propertiesTab",{default:"Properties"}):"Properties",()=>e(l)?s()("assistants.detail.editTab",{default:"Edit"}):"Edit",()=>e(l)?s()("assistants.detail.chatTab",{default:"Chat"}):"Chat"]),c(ze,u)},gt=ze=>{var u=Li(),A=a(u,!0);t(u),f($=>o(A,$),[()=>e(l)?s()("assistants.noAssistantData"):"Assistant data not available."]),c(ze,u)};k(P,ze=>{e(n)==="detail"?ze(me):ze(gt,!1)},De)}};k(_,P=>{e(n)==="create"?P(S):P(R,!1)},y)}};k(Zt,_=>{e(n)==="list"?_(ma):_(Xt,!1)})}var Qt=i(Zt,2);{var ea=_=>{Xo(_,{get originalName(){return e(ve)},get defaultNewName(){return e(we)},get error(){return e(le)},get isOpen(){return e(he)},set isOpen(y){r(he,y,!0)},get isSubmitting(){return e(Ce)},set isSubmitting(y){r(Ce,y,!0)},$$events:{submit:q,close:()=>{r(he,!1),r(X,null),r(re,null),r(le,"")}}})};k(Qt,_=>{e(he)&&_(ea)})}var ta=i(Qt,2);{var ba=_=>{const y=Ua(()=>e(_e)||"");ri(_,{get assistantName(){return e(y)},get error(){return e(Re)},get isOpen(){return e(J)},set isOpen(S){r(J,S,!0)},get isDeleting(){return e(Le)},set isDeleting(S){r(Le,S,!0)},$$events:{confirm:Se,close:()=>{r(J,!1),r(be,null),r(_e,null),r(Re,"")}}})};k(ta,_=>{e(J)&&_(ba)})}var aa=i(ta,2);{var Da=_=>{var y=Ri(),S=a(y,!0);t(y),f(R=>o(S,R),[()=>e(l)?s()("assistants.loadingDetail"):"Loading assistant details..."]),c(_,y)};k(aa,_=>{e(fe)&&_(Da)})}f((_,y,S)=>{o(pa,_),wa(ga,1,`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm rounded-t-md transition-colors duration-150 ${e(n)==="list"?"bg-brand text-white border-brand":"border-transparent text-gray-800 hover:text-gray-900 hover:border-gray-400"}`),Vr(ga,e(n)==="list"?"background-color: #2271b3; color: white; border-color: #2271b3;":""),o(ja,y),wa(ot,1,`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm rounded-t-md ${e(n)==="create"?"bg-brand text-white border-brand":"border-transparent text-gray-800 hover:text-gray-900 hover:border-gray-400"}`),Vr(ot,e(n)==="create"?"background-color: #2271b3; color: white; border-color: #2271b3;":""),o($e,S)},[()=>e(l)?s()("assistants.title"):"Learning Assistants",()=>e(l)?s()("assistants.myAssistantsTab"):"My Assistants",()=>e(l)?s()("assistants.createAssistantTab"):"Create Assistant"]),c(I,jt),lr(),L()}ir(["click"]);export{an as component};
